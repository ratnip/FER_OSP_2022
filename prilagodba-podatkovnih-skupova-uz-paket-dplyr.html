<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>11 Prilagodba podatkovnih skupova uz paket dplyr | Programirajmo u R-u</title>
  <meta name="description" content="Udžbenik za predmet ‘Osnove statističkog programiranja’ na Fakultetu elektrotehnike i računarstva, Sveučilište u Zagrebu." />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="11 Prilagodba podatkovnih skupova uz paket dplyr | Programirajmo u R-u" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Udžbenik za predmet ‘Osnove statističkog programiranja’ na Fakultetu elektrotehnike i računarstva, Sveučilište u Zagrebu." />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="11 Prilagodba podatkovnih skupova uz paket dplyr | Programirajmo u R-u" />
  
  <meta name="twitter:description" content="Udžbenik za predmet ‘Osnove statističkog programiranja’ na Fakultetu elektrotehnike i računarstva, Sveučilište u Zagrebu." />
  

<meta name="author" content="Damir Pintar" />


<meta name="date" content="2022-12-14" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="datumi.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>

<style type="text/css">
.showopt {
  background-color: #004c93;
  color: #FFFFFF; 
  width: 140px;
  height: 4	0px;
  text-align: center;
  vertical-align: middle !important;
  float: right;
  font-family: sans-serif;
  font-size:10 pt;
  border-radius: 8px;
}

.showopt:hover {
    background-color: #dfe4f2;
    color: #004c93;
}

pre.plot {
  background-color: white !important;
}
</style>

<script>
 $(document).ready(function() {

  $chunks = $('.fold');

  $chunks.each(function () {

    // add button to source code chunks
    if ( $(this).hasClass('s') ) {
      $('pre.r', this).prepend("<div class=\"showopt\">Prikaži rješenje</div><br style=\"line-height:22px;\"/>");
      $('pre.r', this).children('code').attr('class', 'folded');
    }

    // add button to output chunks
    if ( $(this).hasClass('o') ) {
      $('pre:not(.r)', this).has('code').prepend("<div class=\"showopt\">Prikaži ispis</div><br style=\"line-height:22px;\"/>");
      $('pre:not(.r)', this).children('code:not(r)').addClass('folded');

      // add button to plots
      $(this).find('img').wrap('<pre class=\"plot\"></pre>');
      $('pre.plot', this).prepend("<div class=\"showopt\">Prikaži sliku</div><br style=\"line-height:22px;\"/>");
      $('pre.plot', this).children('img').addClass('folded');

    }
  });

  // hide all chunks when document is loaded
  $('.folded').css('display', 'none')

  // function to toggle the visibility
  $('.showopt').click(function() {
    var label = $(this).html();
    if (label.indexOf("Prikaži") >= 0) {
      $(this).html(label.replace("Prikaži", "Sakrij"));
    } else {
      $(this).html(label.replace("Sakrij", "Prikaži"));
    }
    $(this).siblings('code, img').slideToggle('fast', 'swing');
  });
});
</script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>(Udžbenik za predmet “Osnove statističkog programiranja”)</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#predgovor"><i class="fa fa-check"></i>Predgovor</a></li>
</ul></li>
<li class="part"><span><b>I Osnovni elementi jezika R</b></span></li>
<li class="chapter" data-level="1" data-path="uvod.html"><a href="uvod.html"><i class="fa fa-check"></i><b>1</b> Uvod</a>
<ul>
<li class="chapter" data-level="1.1" data-path="uvod.html"><a href="uvod.html#što-je-programski-jezik-r"><i class="fa fa-check"></i><b>1.1</b> Što je programski jezik R?</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="uvod.html"><a href="uvod.html#općenito-o-r-u"><i class="fa fa-check"></i><b>1.1.1</b> Općenito o R-u</a></li>
<li class="chapter" data-level="1.1.2" data-path="uvod.html"><a href="uvod.html#alternative-jeziku-r"><i class="fa fa-check"></i><b>1.1.2</b> Alternative jeziku R</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="uvod.html"><a href="uvod.html#instalacija-programske-podrške"><i class="fa fa-check"></i><b>1.2</b> Instalacija programske podrške</a></li>
<li class="chapter" data-level="1.3" data-path="uvod.html"><a href="uvod.html#pregled-razvojnog-sučelja-rstudio"><i class="fa fa-check"></i><b>1.3</b> Pregled razvojnog sučelja <em>RStudio</em></a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="uvod.html"><a href="uvod.html#interaktivna-konzola"><i class="fa fa-check"></i><b>1.3.1</b> Interaktivna konzola</a></li>
<li class="chapter" data-level="1.3.2" data-path="uvod.html"><a href="uvod.html#pisanje-r-skripti"><i class="fa fa-check"></i><b>1.3.2</b> Pisanje R skripti</a></li>
<li class="chapter" data-level="1.3.3" data-path="uvod.html"><a href="uvod.html#r-markdown"><i class="fa fa-check"></i><b>1.3.3</b> <em>R Markdown</em></a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="uvod.html"><a href="uvod.html#kako-koristiti-ovaj-udžbenik"><i class="fa fa-check"></i><b>1.4</b> Kako koristiti ovaj udžbenik?</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tipovi.html"><a href="tipovi.html"><i class="fa fa-check"></i><b>2</b> Osnovni tipovi podataka i operatori</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tipovi.html"><a href="tipovi.html#osnovni-tipovi-podataka"><i class="fa fa-check"></i><b>2.1</b> Osnovni tipovi podataka</a></li>
<li class="chapter" data-level="2.2" data-path="tipovi.html"><a href="tipovi.html#operatori"><i class="fa fa-check"></i><b>2.2</b> Operatori</a></li>
<li class="chapter" data-level="2.3" data-path="tipovi.html"><a href="tipovi.html#nedostajuće-nepoznate-i-nemoguće-vrijednosti"><i class="fa fa-check"></i><b>2.3</b> Nedostajuće, nepoznate i nemoguće vrijednosti</a></li>
<li class="chapter" data-level="" data-path="tipovi.html"><a href="tipovi.html#zadaci-za-vježbu"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="vektori.html"><a href="vektori.html"><i class="fa fa-check"></i><b>3</b> Vektori, matrice i liste</a>
<ul>
<li class="chapter" data-level="3.1" data-path="vektori.html"><a href="vektori.html#vektori-1"><i class="fa fa-check"></i><b>3.1</b> Vektori</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="vektori.html"><a href="vektori.html#stvaranje-vektora"><i class="fa fa-check"></i><b>3.1.1</b> Stvaranje vektora</a></li>
<li class="chapter" data-level="3.1.2" data-path="vektori.html"><a href="vektori.html#operator"><i class="fa fa-check"></i><b>3.1.2</b> Operator <code>[</code></a></li>
<li class="chapter" data-level="3.1.3" data-path="vektori.html"><a href="vektori.html#principi-vektorizacije-i-recikliranja"><i class="fa fa-check"></i><b>3.1.3</b> Principi vektorizacije i recikliranja</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="vektori.html"><a href="vektori.html#indeksni-vektori"><i class="fa fa-check"></i><b>3.2</b> Indeksni vektori</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="vektori.html"><a href="vektori.html#lokacijsko-referenciranje"><i class="fa fa-check"></i><b>3.2.1</b> Lokacijsko referenciranje</a></li>
<li class="chapter" data-level="3.2.2" data-path="vektori.html"><a href="vektori.html#uvjetno-referenciranje"><i class="fa fa-check"></i><b>3.2.2</b> Uvjetno referenciranje</a></li>
<li class="chapter" data-level="3.2.3" data-path="vektori.html"><a href="vektori.html#imensko-referenciranje"><i class="fa fa-check"></i><b>3.2.3</b> Imensko referenciranje</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="vektori.html"><a href="vektori.html#matrice-i-polja"><i class="fa fa-check"></i><b>3.3</b> Matrice i polja</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="vektori.html"><a href="vektori.html#rezanje-matrica"><i class="fa fa-check"></i><b>3.3.1</b> Rezanje matrica</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="vektori.html"><a href="vektori.html#liste"><i class="fa fa-check"></i><b>3.4</b> Liste</a></li>
<li class="chapter" data-level="" data-path="vektori.html"><a href="vektori.html#zadaci-za-vježbu-1"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="okviri.html"><a href="okviri.html"><i class="fa fa-check"></i><b>4</b> Podatkovni okviri i faktori</a>
<ul>
<li class="chapter" data-level="4.1" data-path="okviri.html"><a href="okviri.html#podatkovni-okviri"><i class="fa fa-check"></i><b>4.1</b> Podatkovni okviri</a></li>
<li class="chapter" data-level="4.2" data-path="okviri.html"><a href="okviri.html#odabir-redaka-i-stupaca-podatkovnih-okvira"><i class="fa fa-check"></i><b>4.2</b> Odabir redaka i stupaca podatkovnih okvira</a></li>
<li class="chapter" data-level="4.3" data-path="okviri.html"><a href="okviri.html#dodavanje-i-brisanje-redaka-i-stupaca"><i class="fa fa-check"></i><b>4.3</b> Dodavanje i brisanje redaka i stupaca</a></li>
<li class="chapter" data-level="4.4" data-path="okviri.html"><a href="okviri.html#faktori"><i class="fa fa-check"></i><b>4.4</b> Faktori</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="okviri.html"><a href="okviri.html#primjer-4.1---problem-automatske-kategorizacije"><i class="fa fa-check"></i><b>4.4.1</b> Primjer 4.1 - problem automatske kategorizacije</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="okviri.html"><a href="okviri.html#zadaci-za-vježbu-2"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="kontrola.html"><a href="kontrola.html"><i class="fa fa-check"></i><b>5</b> Kontrola toka i objekti</a>
<ul>
<li class="chapter" data-level="5.1" data-path="kontrola.html"><a href="kontrola.html#naredbe-kontrole-toka"><i class="fa fa-check"></i><b>5.1</b> Naredbe kontrole toka</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="kontrola.html"><a href="kontrola.html#uvjetno-izvođenje-naredbi"><i class="fa fa-check"></i><b>5.1.1</b> Uvjetno izvođenje naredbi</a></li>
<li class="chapter" data-level="5.1.2" data-path="kontrola.html"><a href="kontrola.html#programske-petlje"><i class="fa fa-check"></i><b>5.1.2</b> Programske petlje</a></li>
<li class="chapter" data-level="5.1.3" data-path="kontrola.html"><a href="kontrola.html#petlja-repeat"><i class="fa fa-check"></i><b>5.1.3</b> Petlja <code>repeat</code></a></li>
<li class="chapter" data-level="5.1.4" data-path="kontrola.html"><a href="kontrola.html#petlja-while"><i class="fa fa-check"></i><b>5.1.4</b> Petlja <code>while</code></a></li>
<li class="chapter" data-level="5.1.5" data-path="kontrola.html"><a href="kontrola.html#petlja-for"><i class="fa fa-check"></i><b>5.1.5</b> Petlja <code>for</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="kontrola.html"><a href="kontrola.html#zadaci-za-vježbu-3"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="paketi.html"><a href="paketi.html"><i class="fa fa-check"></i><b>6</b> Paketi, ugrađene funkcije i okoline</a>
<ul>
<li class="chapter" data-level="6.1" data-path="paketi.html"><a href="paketi.html#rad-s-paketima"><i class="fa fa-check"></i><b>6.1</b> Rad s paketima</a></li>
<li class="chapter" data-level="6.2" data-path="paketi.html"><a href="paketi.html#ugrađene-funkcije"><i class="fa fa-check"></i><b>6.2</b> Ugrađene funkcije</a></li>
<li class="chapter" data-level="6.3" data-path="paketi.html"><a href="paketi.html#okoline"><i class="fa fa-check"></i><b>6.3</b> Okoline</a></li>
<li class="chapter" data-level="" data-path="paketi.html"><a href="paketi.html#zadaci-za-vježbu-4"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="korisnik.html"><a href="korisnik.html"><i class="fa fa-check"></i><b>7</b> Korisnički definirane funkcije</a>
<ul>
<li class="chapter" data-level="7.1" data-path="korisnik.html"><a href="korisnik.html#kako-definirati-funkciju"><i class="fa fa-check"></i><b>7.1</b> Kako definirati funkciju</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="korisnik.html"><a href="korisnik.html#princip-kopiranja-kod-izmjene-copy-on-modify"><i class="fa fa-check"></i><b>7.1.1</b> Princip “kopiranja kod izmjene” (copy-on-modify)</a></li>
<li class="chapter" data-level="7.1.2" data-path="korisnik.html"><a href="korisnik.html#funkcija-kao-objekt"><i class="fa fa-check"></i><b>7.1.2</b> Funkcija kao objekt</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="korisnik.html"><a href="korisnik.html#što-su-apply-funkcije"><i class="fa fa-check"></i><b>7.2</b> Što su <code>apply</code> funkcije?</a></li>
<li class="chapter" data-level="7.3" data-path="korisnik.html"><a href="korisnik.html#funkcija-apply"><i class="fa fa-check"></i><b>7.3</b> Funkcija <code>apply</code></a></li>
<li class="chapter" data-level="7.4" data-path="korisnik.html"><a href="korisnik.html#funkcije-lapply-sapply-i-vapply"><i class="fa fa-check"></i><b>7.4</b> Funkcije <code>lapply</code>, <code>sapply</code> i <code>vapply</code></a></li>
<li class="chapter" data-level="7.5" data-path="korisnik.html"><a href="korisnik.html#ostale-funkcije-iz-porodice-apply-i-dostupne-alternative"><i class="fa fa-check"></i><b>7.5</b> Ostale funkcije iz porodice <code>apply</code> i dostupne alternative</a></li>
<li class="chapter" data-level="" data-path="korisnik.html"><a href="korisnik.html#zadaci-za-vježbu-5"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="objekti.html"><a href="objekti.html"><i class="fa fa-check"></i><b>8</b> Objektni modeli</a>
<ul>
<li class="chapter" data-level="8.1" data-path="objekti.html"><a href="objekti.html#objektni-modeli-u-jeziku-r"><i class="fa fa-check"></i><b>8.1</b> Objektni modeli u jeziku R</a></li>
<li class="chapter" data-level="8.2" data-path="objekti.html"><a href="objekti.html#četiri-tipa-objekata-u-r-u"><i class="fa fa-check"></i><b>8.2</b> Četiri tipa objekata u R-u</a></li>
<li class="chapter" data-level="8.3" data-path="objekti.html"><a href="objekti.html#pomoćni-paket-sloop"><i class="fa fa-check"></i><b>8.3</b> Pomoćni paket <code>sloop</code></a></li>
<li class="chapter" data-level="8.4" data-path="objekti.html"><a href="objekti.html#pregled-objektnog-modela-s3"><i class="fa fa-check"></i><b>8.4</b> Pregled objektnog modela S3</a></li>
<li class="chapter" data-level="8.5" data-path="objekti.html"><a href="objekti.html#nasljeđivanje"><i class="fa fa-check"></i><b>8.5</b> Nasljeđivanje</a></li>
<li class="chapter" data-level="8.6" data-path="objekti.html"><a href="objekti.html#generičke-funkcije"><i class="fa fa-check"></i><b>8.6</b> Generičke funkcije</a></li>
<li class="chapter" data-level="8.7" data-path="objekti.html"><a href="objekti.html#mehanizam-generičkih-funkcija"><i class="fa fa-check"></i><b>8.7</b> Mehanizam generičkih funkcija</a></li>
<li class="chapter" data-level="8.8" data-path="objekti.html"><a href="objekti.html#svojstva-generičke-funkcije"><i class="fa fa-check"></i><b>8.8</b> Svojstva generičke funkcije</a></li>
<li class="chapter" data-level="8.9" data-path="objekti.html"><a href="objekti.html#implementacija-generičke-funkcije"><i class="fa fa-check"></i><b>8.9</b> Implementacija generičke funkcije</a></li>
<li class="chapter" data-level="8.10" data-path="objekti.html"><a href="objekti.html#funkcija-methods"><i class="fa fa-check"></i><b>8.10</b> Funkcija <code>methods</code></a></li>
<li class="chapter" data-level="8.11" data-path="objekti.html"><a href="objekti.html#zaključci-o-s3-objektima"><i class="fa fa-check"></i><b>8.11</b> Zaključci o S3 objektima</a></li>
<li class="chapter" data-level="8.12" data-path="objekti.html"><a href="objekti.html#kratki-pregled-s4-objekata"><i class="fa fa-check"></i><b>8.12</b> Kratki pregled S4 objekata</a></li>
<li class="chapter" data-level="" data-path="objekti.html"><a href="objekti.html#zadaci-za-vježbu-6"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="part"><span><b>II Upravljanje podacima i vizualizacije</b></span></li>
<li class="chapter" data-level="9" data-path="cijev.html"><a href="cijev.html"><i class="fa fa-check"></i><b>9</b> Koncept urednih podataka</a>
<ul>
<li class="chapter" data-level="9.1" data-path="cijev.html"><a href="cijev.html#operator-cjevovoda"><i class="fa fa-check"></i><b>9.1</b> Operator cjevovoda</a></li>
<li class="chapter" data-level="9.2" data-path="cijev.html"><a href="cijev.html#uredni-podaci"><i class="fa fa-check"></i><b>9.2</b> Uredni podaci</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="cijev.html"><a href="cijev.html#funkcije-pivot_longer-i-pivot_wider"><i class="fa fa-check"></i><b>9.2.1</b> Funkcije <code>pivot_longer</code> i <code>pivot_wider</code></a></li>
<li class="chapter" data-level="9.2.2" data-path="cijev.html"><a href="cijev.html#funkcije-separate-i-unite"><i class="fa fa-check"></i><b>9.2.2</b> Funkcije <code>separate</code> i <code>unite</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="cijev.html"><a href="cijev.html#zadaci-za-vježbu-7"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="10" data-path="datumi.html"><a href="datumi.html"><i class="fa fa-check"></i><b>10</b> Rad sa datumima i znakovnim nizovima</a>
<ul>
<li class="chapter" data-level="10.1" data-path="datumi.html"><a href="datumi.html#rad-sa-datumima"><i class="fa fa-check"></i><b>10.1</b> Rad sa datumima</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="datumi.html"><a href="datumi.html#klasa-date"><i class="fa fa-check"></i><b>10.1.1</b> Klasa <code>Date</code></a></li>
<li class="chapter" data-level="10.1.2" data-path="datumi.html"><a href="datumi.html#klase-posixct-i-posixlt"><i class="fa fa-check"></i><b>10.1.2</b> Klase <code>POSIXct</code> i <code>POSIXlt</code></a></li>
<li class="chapter" data-level="10.1.3" data-path="datumi.html"><a href="datumi.html#paket-lubridate"><i class="fa fa-check"></i><b>10.1.3</b> Paket <code>lubridate</code></a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="datumi.html"><a href="datumi.html#rad-sa-znakovnim-nizovima"><i class="fa fa-check"></i><b>10.2</b> Rad sa znakovnim nizovima</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="datumi.html"><a href="datumi.html#analiza-teksta-i-regularni-izrazi"><i class="fa fa-check"></i><b>10.2.1</b> Analiza teksta i regularni izrazi</a></li>
<li class="chapter" data-level="10.2.2" data-path="datumi.html"><a href="datumi.html#paket-stringr"><i class="fa fa-check"></i><b>10.2.2</b> Paket <code>stringr</code></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="datumi.html"><a href="datumi.html#zadaci-za-vježbu-8"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><i class="fa fa-check"></i><b>11</b> Prilagodba podatkovnih skupova uz paket <code>dplyr</code></a>
<ul>
<li class="chapter" data-level="11.1" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#ogledni-podatkovni-skup-titanic"><i class="fa fa-check"></i><b>11.1</b> Ogledni podatkovni skup: <em>Titanic</em></a></li>
<li class="chapter" data-level="11.2" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-podskupa-obzervacija-uz-filter-i-slice"><i class="fa fa-check"></i><b>11.2</b> Stvaranje podskupa obzervacija uz <code>filter</code> i <code>slice</code></a></li>
<li class="chapter" data-level="11.3" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-podskupa-varijabli-uz-select"><i class="fa fa-check"></i><b>11.3</b> Stvaranje podskupa varijabli uz <code>select</code></a></li>
<li class="chapter" data-level="11.4" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-novih-stupaca-uz-mutate"><i class="fa fa-check"></i><b>11.4</b> Stvaranje novih stupaca uz <code>mutate</code></a></li>
<li class="chapter" data-level="11.5" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#ogledni-podatkovni-skup-houston-flights"><i class="fa fa-check"></i><b>11.5</b> Ogledni podatkovni skup: <em>Houston flights</em></a></li>
<li class="chapter" data-level="11.6" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#grupiranje-i-agregacija-uz-group_by-i-summarise"><i class="fa fa-check"></i><b>11.6</b> Grupiranje i agregacija uz <code>group_by</code> i <code>summarise</code></a></li>
<li class="chapter" data-level="11.7" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#spajanje-podatkovnih-okvira-uz-join-funkcije"><i class="fa fa-check"></i><b>11.7</b> Spajanje podatkovnih okvira uz join funkcije</a></li>
<li class="chapter" data-level="11.8" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#integracija-sa-relacijskim-bazama-podataka"><i class="fa fa-check"></i><b>11.8</b> Integracija sa relacijskim bazama podataka</a></li>
<li class="chapter" data-level="" data-path="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#zadaci-za-vježbu-9"><i class="fa fa-check"></i>Zadaci za vježbu</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Programirajmo u R-u</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="prilagodba-podatkovnih-skupova-uz-paket-dplyr" class="section level1 hasAnchor" number="11">
<h1><span class="header-section-number">11</span> Prilagodba podatkovnih skupova uz paket <code>dplyr</code><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#prilagodba-podatkovnih-skupova-uz-paket-dplyr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>Paket <code>dplyr</code> jedan je od novijih paketa jezika <em>R</em> čija je glavna funkcija učinkovito i pojednostavljeno upravljanje podatkovnim okvirima uz pomoć skupa intuitivno dizajniranih funkcija. U trenutku pisanja ove lekcije <a href = "https://www.rdocumentation.org/"> nalazi se na vrhu liste najpopularnijih paketa </a> usprkos jakoj “konkurenciji” u ovom području koju čine iznimno popularni paketi kao što su <code>plyr</code>, <code>data.table</code> ali i osnovne, tradicionalne metode za rad sa podatkovnim okvirima. Bilo koja od ovih opcija predstavlja dobar izbor, a iako paket <code>dplyr</code> nije najučinkovitiji glede samih performansi (daleko najbolje performanse trenutno nudi paket <code>data.table</code>), prednost ovog paketa je njegova intuitivna, čitljiva sintaksa koja programski rad sa podatkovnim okvirima čini brzim i jednostavnim te je odličan izbor za programere koji se upoznaju sa <em>R</em>-om ili se jednostavno žele usredotočiti na rad sa podacima kroz čitljiv, lako održiv programski kod.</p>
<p>Konkretne prednosti koje donosi paket <code>dplyr</code> su sljedeće:</p>
<ul>
<li>jednostavna sintaksa (slična SQL-u, ali proceduralna) koja koristi pet glavnih “glagola” za manipulaciju podatkovnim okvirima i kao takva definira svojevrsni samostalni jezik unutar jezika <em>R</em></li>
<li>veća učinkovitost od metoda koje nudi osnovni paket (inicijalno je <code>dplyr</code> dizajniran za veću učinkovitost programiranja, ne nužno za bolje performanse, no u međuvremenu implementacija određenih rutina u C-u omogućila je i poboljšanje i performansi izvođenja)</li>
<li>integracija sa relacijskim bazama podataka (funkcije paketa <code>dplyr</code> mogu se koristiti direktno nad tablicama u bazi uz pomoć automatskog prevođenja funkcija paketa <code>dplyr</code> u SQL naredbe)</li>
</ul>
<p>Spomenutih osnovnih “pet glagola” koje nudi paket <code>dplyr</code> su sljedeći:</p>
<ul>
<li><code>filter</code> - za filtriranje podatkovnog skupa po retcima</li>
<li><code>select</code> - za odabir pojedinih stupaca</li>
<li><code>arrange</code> - za promjenu redoslijeda redaka</li>
<li><code>mutate</code> - za stvaranje novih stupaca iz postojećih</li>
<li><code>summarise</code> - za agregiranje podataka</li>
</ul>
<p>Pored pet osnovnih glagola vrlo često koristimo i:</p>
<ul>
<li><code>group_by</code> za grupiranje podataka unutar podatkovnog skupa</li>
<li>porodicu <code>join</code> funkcija za spajanje podatkovnih okvira</li>
</ul>
<p>Poznavatelji jezika SQL lako će uočiti paralele između tog jezika i navedenih funkcionalnosti paketa <code>dplyr</code>. Najveća razlika jest u tome što SQL radi “deklarativno”, tj. moramo pratiti pravila izgradnje SQL naredbe koja “sve radi odjednom”, dok u <em>R</em>-u uz pomoć funkcija paketa <code>dplyr</code> i već ranije upoznatog operatora <code>%&gt;%</code> radnje nad podatkovnim skupovima možemo izvoditi proceduralno, s jasnim tijekom obrade podataka slijeva na desno.</p>
<p>Prije detaljnog pregleda funkcionalnosti paketa <code>dplyr</code> pogledajmo ogledni podatkovni skup kojeg ćemo koristiti tijekom ove lekcije.</p>
<div id="ogledni-podatkovni-skup-titanic" class="section level2 hasAnchor" number="11.1">
<h2><span class="header-section-number">11.1</span> Ogledni podatkovni skup: <em>Titanic</em><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#ogledni-podatkovni-skup-titanic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Odaberimo za početak jedan često korišteni podatkovni skup – <em>“Titanic Passenger Survival Dataset”</em>. Ovaj skup pruža informacije o sudbinama putnika prekoocenaskog putničkog broda Titanic koji je potonuo 14. travnja 1912. godine pri čemu je od 2223 putnika i članova posade preživjelo samo njih 706. Podatkovni skup između ostalog sadrži imena putnika, spol, godište u trenutku potonuća, putničku klasu i sl. Postoji inačica ovog podatkovnog skupa koja dolazi sa samom <em>R</em> distribucijom, no mi ćemo koristiti njegovu proširenu inačicu sa <em>Kaggle</em> natjecanja <em>“Titanic: Machine Learning From Disaster”</em> o kojem se više detalja može saznati na <a href = "https://www.kaggle.com/c/titanic">ovoj poveznici</a>.</p>
<p>Učitajmo ovaj podatkovni skup uz pomoć funkcije <code>read_csv</code>, funkcije paketa <code>readr</code> koja “nadograđuje” funkciju <code>read.csv</code>. Isto tako, umjesto funkcije <code>str</code>, pokušajmo koristiti njezin ekvivalent <code>glimpse</code> kojeg nudi paket <code>dplyr</code>.</p>
<hr />
<p><strong>Zadatak 11.1 - podatkovni skup <code>Titanic</code></strong></p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb452-1" aria-hidden="true" tabindex="-1"></a><span class="co"># učitajte podatkovni skup iz datoteke `Titanic.csv` u varijablu `titanic` uz pomoć funkcije `read_csv` iz paketa `readr`</span></span>
<span id="cb452-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb452-2" aria-hidden="true" tabindex="-1"></a><span class="co"># prije korištenja funkcije proučite dokumentaciju iste</span></span>
<span id="cb452-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb452-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb452-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb452-4" aria-hidden="true" tabindex="-1"></a><span class="co">#pogledajte strukturu podatkovnog okvira `titanic` uz pomoć funkcije `glimpse`</span></span>
<span id="cb452-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb452-5" aria-hidden="true" tabindex="-1"></a><span class="co">#i prvih nekoliko redaka uz pomoć funkcije `head`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb453-1" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">&quot;Titanic.csv&quot;</span>)</span>
<span id="cb453-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb453-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb453-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb453-3" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(titanic)</span>
<span id="cb453-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb453-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(titanic)</span></code></pre></div>
<pre><code>## Rows: 891 Columns: 12
## ── Column specification ───────────────────────────────────────
## Delimiter: &quot;,&quot;
## chr (5): Name, Sex, Ticket, Cabin, Embarked
## dbl (7): PassengerId, Survived, Pclass, Age, SibSp, Parch, Fare
## 
## ℹ Use `spec()` to retrieve the full column specification for this data.
## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
<pre><code>## Rows: 891
## Columns: 12
## $ PassengerId &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…
## $ Survived    &lt;dbl&gt; 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1…
## $ Pclass      &lt;dbl&gt; 3, 1, 3, 1, 3, 3, 1, 3, 3, 2, 3, 1, 3, 3, 3, 2, 3, 2, 3, 3…
## $ Name        &lt;chr&gt; &quot;Braund, Mr. Owen Harris&quot;, &quot;Cumings, Mrs. John Bradley (Fl…
## $ Sex         &lt;chr&gt; &quot;male&quot;, &quot;female&quot;, &quot;female&quot;, &quot;female&quot;, &quot;male&quot;, &quot;male&quot;, &quot;mal…
## $ Age         &lt;dbl&gt; 22, 38, 26, 35, 35, NA, 54, 2, 27, 14, 4, 58, 20, 39, 14, …
## $ SibSp       &lt;dbl&gt; 1, 1, 0, 1, 0, 0, 0, 3, 0, 1, 1, 0, 0, 1, 0, 0, 4, 0, 1, 0…
## $ Parch       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 0, 0, 5, 0, 0, 1, 0, 0, 0…
## $ Ticket      &lt;chr&gt; &quot;A/5 21171&quot;, &quot;PC 17599&quot;, &quot;STON/O2. 3101282&quot;, &quot;113803&quot;, &quot;37…
## $ Fare        &lt;dbl&gt; 7.2500, 71.2833, 7.9250, 53.1000, 8.0500, 8.4583, 51.8625,…
## $ Cabin       &lt;chr&gt; NA, &quot;C85&quot;, NA, &quot;C123&quot;, NA, NA, &quot;E46&quot;, NA, NA, NA, &quot;G6&quot;, &quot;C…
## $ Embarked    &lt;chr&gt; &quot;S&quot;, &quot;C&quot;, &quot;S&quot;, &quot;S&quot;, &quot;S&quot;, &quot;Q&quot;, &quot;S&quot;, &quot;S&quot;, &quot;S&quot;, &quot;C&quot;, &quot;S&quot;, &quot;S&quot;…
## # A tibble: 6 × 12
##   PassengerId Survived Pclass Name    Sex     Age SibSp Parch Ticket  Fare Cabin
##         &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1           1        0      3 Braund… male     22     1     0 A/5 2…  7.25 &lt;NA&gt; 
## 2           2        1      1 Cuming… fema…    38     1     0 PC 17… 71.3  C85  
## 3           3        1      3 Heikki… fema…    26     0     0 STON/…  7.92 &lt;NA&gt; 
## 4           4        1      1 Futrel… fema…    35     1     0 113803 53.1  C123 
## 5           5        0      3 Allen,… male     35     0     0 373450  8.05 &lt;NA&gt; 
## 6           6        0      3 Moran,… male     NA     0     0 330877  8.46 &lt;NA&gt; 
## # … with 1 more variable: Embarked &lt;chr&gt;</code></pre>
</div>
<hr />
<p>Zašto koristiti funkciju <code>read_csv</code> umjesto funkcije sličnog imena <code>read.csv</code>? Postoji nekoliko razloga:</p>
<ul>
<li>veća autonomija, tj. kvalitetnije ugrađene vrijednosti nazivnih parametara</li>
<li>veća brzina</li>
<li>ispis statusnih informacija radi lakšeg uočavanja grešaka</li>
<li>učitani objekt se automatski pretvara u “<em>tibble</em>”</li>
</ul>
<p>Svi ovi razlozi su jasni, osim možda zadnjeg. Što je “<em>tibble</em>”? To je kolokvijalni naziv za objekt klase <code>tbl_df</code>, koja predstavlja svojevrsnu nadogradnju klase <code>data.frame</code>, tj. osnovnog podatkovnog okvira. Najveća prednost ovog tipa objekta jest što će se kod pokušaja ispisa cijelog okvira na zaslon (što se najčešće događa omaškom i što rezultira “smrzavanjem” <em>R</em> konzole) pozvati posebna funkcija koja će ispisati samo dio okvira i moći će se odmah nastaviti s radom.</p>
<p>Ako želimo neki postojeći podatkovni okvir “nadograditi” u <em>tibble</em>, to možemo učiniti uz pomoć naredbe <code>as_tibble</code> (uočite kako se funkcije iz kolekcije <code>tidyverse</code> često oslanjaju na podcrtu tj. “<em>underscore</em>” kako bi ih lakše identificirali kao nadogradnje osnovnih funkcija koje imaju slične nazive ali koriste točku).</p>
<p>Uz pomoć funkcije <code>options</code> i parametara <code>tibble.print_max</code> i <code>tibble.width</code> možemo kontrolirati koliko u općenitom slučaju želimo ispisati stupaca i redaka u općenitom slučaju npr:</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb456-1" aria-hidden="true" tabindex="-1"></a><span class="co"># zelim u ispisu vidjeti najvise 10 redaka ali sve stupce</span></span>
<span id="cb456-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb456-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">tibble.print_max =</span> <span class="dv">10</span>, <span class="at">tibble.width =</span> <span class="cn">Inf</span>)</span></code></pre></div>
<p>a kod pojedinog ispisa broj redaka možemo birati uz pomoć parametra <code>n</code>:</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb457-1" aria-hidden="true" tabindex="-1"></a><span class="co"># `df` je klase `tbl`, zelim vidjeti 50 redaka u ispisu</span></span>
<span id="cb457-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb457-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(df, <span class="at">n =</span> <span class="dv">50</span>)</span></code></pre></div>
<hr />
<p>Prije nastavka bilo bi dobro pobliže se upoznati sa podatkovnim skupom kojeg ćemo koristiti, bilo nešto detaljnijim istraživanjem podatkovnog skupa, bilo prikupljanjem dokumentacije o istom. Kraći opis samog podatkovnog skupa preuzet sa službenih stranica Keggle natjecanja slijedi:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-1" aria-hidden="true" tabindex="-1"></a>VARIABLE DESCRIPTIONS<span class="sc">:</span></span>
<span id="cb458-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-2" aria-hidden="true" tabindex="-1"></a>survival        Survival</span>
<span id="cb458-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-3" aria-hidden="true" tabindex="-1"></a>                (<span class="dv">0</span> <span class="ot">=</span> No; <span class="dv">1</span> <span class="ot">=</span> Yes)</span>
<span id="cb458-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-4" aria-hidden="true" tabindex="-1"></a>pclass          Passenger Class</span>
<span id="cb458-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-5" aria-hidden="true" tabindex="-1"></a>                (<span class="dv">1</span> <span class="ot">=</span> 1st; <span class="dv">2</span> <span class="ot">=</span> 2nd; <span class="dv">3</span> <span class="ot">=</span> 3rd)</span>
<span id="cb458-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-6" aria-hidden="true" tabindex="-1"></a>name            Name</span>
<span id="cb458-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-7" aria-hidden="true" tabindex="-1"></a>sex             Sex</span>
<span id="cb458-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-8" aria-hidden="true" tabindex="-1"></a>age             Age</span>
<span id="cb458-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-9" aria-hidden="true" tabindex="-1"></a>sibsp           Number of Siblings<span class="sc">/</span>Spouses Aboard</span>
<span id="cb458-10"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-10" aria-hidden="true" tabindex="-1"></a>parch           Number of Parents<span class="sc">/</span>Children Aboard</span>
<span id="cb458-11"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-11" aria-hidden="true" tabindex="-1"></a>ticket          Ticket Number</span>
<span id="cb458-12"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-12" aria-hidden="true" tabindex="-1"></a>fare            Passenger Fare</span>
<span id="cb458-13"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-13" aria-hidden="true" tabindex="-1"></a>cabin           Cabin</span>
<span id="cb458-14"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-14" aria-hidden="true" tabindex="-1"></a>embarked        Port of Embarkation</span>
<span id="cb458-15"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-15" aria-hidden="true" tabindex="-1"></a>                (<span class="at">C =</span> Cherbourg; <span class="at">Q =</span> Queenstown; <span class="at">S =</span> Southampton)</span>
<span id="cb458-16"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-17"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-17" aria-hidden="true" tabindex="-1"></a>SPECIAL NOTES<span class="sc">:</span></span>
<span id="cb458-18"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-18" aria-hidden="true" tabindex="-1"></a>Pclass is a proxy <span class="cf">for</span> socio<span class="sc">-</span>economic <span class="fu">status</span> (SES)</span>
<span id="cb458-19"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-19" aria-hidden="true" tabindex="-1"></a> 1st <span class="sc">~</span> Upper; 2nd <span class="sc">~</span> Middle; 3rd <span class="sc">~</span> Lower</span>
<span id="cb458-20"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-21"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-21" aria-hidden="true" tabindex="-1"></a>Age is <span class="cf">in</span> Years; Fractional <span class="cf">if</span> Age less than <span class="fu">One</span> (<span class="dv">1</span>)</span>
<span id="cb458-22"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-22" aria-hidden="true" tabindex="-1"></a> If the Age is Estimated, it is <span class="cf">in</span> the form xx<span class="fl">.5</span></span>
<span id="cb458-23"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-24"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-24" aria-hidden="true" tabindex="-1"></a>With respect to the family relation <span class="fu">variables</span> (i.e. sibsp and parch)</span>
<span id="cb458-25"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-25" aria-hidden="true" tabindex="-1"></a>some relations were ignored.  The following are the definitions used</span>
<span id="cb458-26"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> sibsp and parch.</span>
<span id="cb458-27"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-28"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-28" aria-hidden="true" tabindex="-1"></a>Sibling<span class="sc">:</span>  Brother, Sister, Stepbrother, or Stepsister of Passenger Aboard Titanic</span>
<span id="cb458-29"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-29" aria-hidden="true" tabindex="-1"></a>Spouse<span class="sc">:</span>   Husband or Wife of Passenger Aboard <span class="fu">Titanic</span> (Mistresses and Fiances Ignored)</span>
<span id="cb458-30"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-30" aria-hidden="true" tabindex="-1"></a>Parent<span class="sc">:</span>   Mother or Father of Passenger Aboard Titanic</span>
<span id="cb458-31"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-31" aria-hidden="true" tabindex="-1"></a>Child<span class="sc">:</span>    Son, Daughter, Stepson, or Stepdaughter of Passenger Aboard Titanic</span>
<span id="cb458-32"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb458-33"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-33" aria-hidden="true" tabindex="-1"></a>Other family relatives excluded from this study include cousins,</span>
<span id="cb458-34"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-34" aria-hidden="true" tabindex="-1"></a>nephews<span class="sc">/</span>nieces, aunts<span class="sc">/</span>uncles, and <span class="cf">in</span><span class="sc">-</span>laws.  Some children travelled</span>
<span id="cb458-35"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-35" aria-hidden="true" tabindex="-1"></a>only with a nanny, therefore parch<span class="ot">=</span><span class="dv">0</span> <span class="cf">for</span> them.  As well, some</span>
<span id="cb458-36"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-36" aria-hidden="true" tabindex="-1"></a>travelled with very close friends or neighbors <span class="cf">in</span> a village, however,</span>
<span id="cb458-37"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb458-37" aria-hidden="true" tabindex="-1"></a>the definitions do not support such relations.</span></code></pre></div>
<p>U ovom trenutku bi trebalo razmotriti uključuje li podatkovni skup neke kategorijske podatke. Kao što smo naučili, za razliku od funkcije <code>read.csv</code> koja automatski faktorizira sve znakovne stupce (što nije preporučljivo), funkcija <code>read_csv</code> iz paketa <code>readr</code> ne faktorizira ništa, već to ostavlja na odgovornost analitičaru. Iako ovo predstavlja dodatni posao za analitičara, razina kontrole i robusnosti koja se time dobiva je više nego dostatni kompromis.</p>
<p>U podatkovnom skupu <code>titanic</code> uočavamo sljedeće kategorijske varijable:</p>
<ul>
<li><em>Survival</em> (preživljavanje – 2 kategorije: 0 i 1)</li>
<li><em>Pclass</em> (putnička klasa – 3 kategorije: 1, 2 i 3)</li>
<li><em>Sex</em> (spol – 2 kategorije: “M” i “F”)</li>
<li><em>Embarked</em> (luka ukrcaja – 3 kategorije: “C”, “Q” i “S”)</li>
</ul>
<p>Faktorizirajmo navedene stupce.</p>
<p><strong>Zadatak 11.2 - Kategorizacija stupaca podatkovnoga skupa <code>Titanic</code></strong></p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb459-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pretvorite stupce `Survival`, `Pclass`, `Sex` i `Embarked`</span></span>
<span id="cb459-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb459-2" aria-hidden="true" tabindex="-1"></a><span class="co"># podatkovnog okvira `titanic` u faktore</span></span>
<span id="cb459-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb459-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb459-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb459-4" aria-hidden="true" tabindex="-1"></a><span class="co"># proučite podatkovni okvir `titanic`</span></span>
<span id="cb459-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb459-5" aria-hidden="true" tabindex="-1"></a><span class="co"># uz pomoć funkcije `glimpse`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pretvorite stupce `Survival`, `Pclass`, `Sex` i `Embarked`</span></span>
<span id="cb460-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-2" aria-hidden="true" tabindex="-1"></a><span class="co"># podatkovnog okvira `titanic` u faktore</span></span>
<span id="cb460-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-3" aria-hidden="true" tabindex="-1"></a>titanic<span class="sc">$</span>Survived <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(titanic<span class="sc">$</span>Survived)</span>
<span id="cb460-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-4" aria-hidden="true" tabindex="-1"></a>titanic<span class="sc">$</span>Pclass <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(titanic<span class="sc">$</span>Pclass)</span>
<span id="cb460-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-5" aria-hidden="true" tabindex="-1"></a>titanic<span class="sc">$</span>Sex <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(titanic<span class="sc">$</span>Sex)</span>
<span id="cb460-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-6" aria-hidden="true" tabindex="-1"></a>titanic<span class="sc">$</span>Embarked <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(titanic<span class="sc">$</span>Embarked)</span>
<span id="cb460-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb460-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-9" aria-hidden="true" tabindex="-1"></a><span class="co"># proučite podatkovni okvir `titanic`</span></span>
<span id="cb460-10"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-10" aria-hidden="true" tabindex="-1"></a><span class="co"># uz pomoć funkcije `glimpse`</span></span>
<span id="cb460-11"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb460-11" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(titanic)</span></code></pre></div>
<pre><code>## Rows: 891
## Columns: 12
## $ PassengerId &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17,…
## $ Survived    &lt;fct&gt; 0, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 0, 1…
## $ Pclass      &lt;fct&gt; 3, 1, 3, 1, 3, 3, 1, 3, 3, 2, 3, 1, 3, 3, 3, 2, 3, 2, 3, 3…
## $ Name        &lt;chr&gt; &quot;Braund, Mr. Owen Harris&quot;, &quot;Cumings, Mrs. John Bradley (Fl…
## $ Sex         &lt;fct&gt; male, female, female, female, male, male, male, male, fema…
## $ Age         &lt;dbl&gt; 22, 38, 26, 35, 35, NA, 54, 2, 27, 14, 4, 58, 20, 39, 14, …
## $ SibSp       &lt;dbl&gt; 1, 1, 0, 1, 0, 0, 0, 3, 0, 1, 1, 0, 0, 1, 0, 0, 4, 0, 1, 0…
## $ Parch       &lt;dbl&gt; 0, 0, 0, 0, 0, 0, 0, 1, 2, 0, 1, 0, 0, 5, 0, 0, 1, 0, 0, 0…
## $ Ticket      &lt;chr&gt; &quot;A/5 21171&quot;, &quot;PC 17599&quot;, &quot;STON/O2. 3101282&quot;, &quot;113803&quot;, &quot;37…
## $ Fare        &lt;dbl&gt; 7.2500, 71.2833, 7.9250, 53.1000, 8.0500, 8.4583, 51.8625,…
## $ Cabin       &lt;chr&gt; NA, &quot;C85&quot;, NA, &quot;C123&quot;, NA, NA, &quot;E46&quot;, NA, NA, NA, &quot;G6&quot;, &quot;C…
## $ Embarked    &lt;fct&gt; S, C, S, S, S, Q, S, S, S, C, S, S, S, S, S, S, Q, S, S, C…</code></pre>
</div>
<p>Postoji i sažetija alternativa za faktoriziranje stupaca koja koristi <code>lapply</code>:</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb462-1" aria-hidden="true" tabindex="-1"></a>categories <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Survived&quot;</span>, <span class="st">&quot;Pclass&quot;</span>, <span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Embarked&quot;</span>)</span>
<span id="cb462-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb462-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb462-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb462-3" aria-hidden="true" tabindex="-1"></a>titanic[categories] <span class="ot">&lt;-</span> <span class="fu">lapply</span>(titanic[categories], as.factor)</span></code></pre></div>
<p>Sada kada dobro razumijemo naš podatkovni skup i kada smo obavili inicijalne pripreme u smislu kategorizacije stupaca, možemo krenuti sa upoznavanjem funkcija paketa <code>dplyr</code>.</p>
</div>
<div id="stvaranje-podskupa-obzervacija-uz-filter-i-slice" class="section level2 hasAnchor" number="11.2">
<h2><span class="header-section-number">11.2</span> Stvaranje podskupa obzervacija uz <code>filter</code> i <code>slice</code><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-podskupa-obzervacija-uz-filter-i-slice" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>U poglavlju o podatkovnim okvirima smo već naučili da se “rezanje” podatkovnih okvira može raditi slično rezanju matrica - uz pomoć indeksnih vektora kojima definiramo koje retke/stupce zadržavamo. Isto tako, naučili smo da indeksni vektori mogu biti cjelobrojni (lokacijski), logički i imenski.</p>
<p>Kod definicije podskupa redaka daleko najčešći tip indeksnog vektora je logički - uz pomoć varijabli tj. stupaca definiramo određeni kriterij koji “filtrira” retke. Nažalost, osnovna <em>R</em>-ova sintaksa korištenja logičkih indeksnih redaka za određivanje podskupa redaka je ponešto nespretna, što se može vidjeti iz primjera:</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb463-1" aria-hidden="true" tabindex="-1"></a>podaci[podaci<span class="sc">$</span>a <span class="sc">&gt;</span> <span class="dv">5</span> <span class="sc">&amp;</span> podaci<span class="sc">$</span>b <span class="sc">!=</span> <span class="dv">3</span>, ]</span></code></pre></div>
<p>Prvi i očiti problem jest potreba ponavljanja imena podatkovnog okvira (koju možemo eliminirati uz pomoć funkcije <code>attach</code>, što smo rekli da nije idealno rješenje jer donosi niz novih potencijalnih problema). Drugo pitanje jest problem čitljivosti - gornju naredbu nije lako vizualno interpretirati, tj. naknadnim pregledom koda nije lako odmah uočiti da se radi o reduciranju broja redaka.</p>
<p>Funkcija <code>filter</code> eksplicitnom sintaksom odaje da se radi o filtriranju redaka, a također omogućuje korištenje imena stupaca bez potrebe za referenciranjem imena podatkovnog okvira:</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb464-1" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(podaci, a <span class="sc">&gt;</span> <span class="dv">5</span> <span class="sc">&amp;</span> b <span class="sc">!=</span> <span class="dv">3</span>)</span></code></pre></div>
<p>Isto tako, dobro je uočiti da je prvi argument funkcije sam podatkovni skup, što nam omogućuje jednostavno ulančavanje. Na ovom principu dizajnirana je većina funkcija paketa <code>dplyr</code>.</p>
<p>Gore navedena funkcija predstavlja najčešći način odabira podskupa redaka (poznavatelji SQL-a uočiti će sličnost sa WHERE segmentom SQL upita). Pored funkcije filter, za određivanje podskupa redaka imamo i sljedeće funkcije, također vrlo intuitivnih imena (radi lakše interpretacije umjesto potpisa funkcija dajemo primjere parametara):</p>
<ul>
<li><code>distinct(podaci)</code> - za uklanjanje duplikata</li>
<li><code>slice(podaci, 1:10)</code> - za lokacijsko indeksiranje</li>
<li><code>slice_sample(podaci, n  = 50)</code> - nasumični odabir zadanog broja redaka</li>
<li><code>slice_sample(podaci, prop  = 0.05)</code> - nasumični odabir zadane proporcije redaka</li>
<li><code>slice_min(podaci, a, n = 10)</code> - prvih <code>n</code> redaka, gledano po poretku stupca <code>a</code> uzlazno</li>
<li><code>slice_max(podaci, a, n = 10)</code> - prvih <code>n</code> redaka, gledano po poretku stupca <code>a</code> silazno</li>
<li><code>slice_head(n = 10)</code>, <code>slice_tail(n = 10)</code> - prvih/zadnjih <code>n</code> redaka</li>
</ul>
<p>Za poredak redaka u ispisu možemo koristiti:</p>
<ul>
<li><code>arrange(podaci, a, desc(b))</code> - poredaj po stupcu <code>a</code> uzlazno pa po <code>b</code> silazno</li>
</ul>
<p>Isprobajmo ovo na primjerima:</p>
<hr />
<p><strong>Zadatak 11.3 - odabir redaka</strong></p>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite podatke o svim putnicima/putnicama prve klase starijim od 60 godina</span></span>
<span id="cb465-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite podatke o svim preživjelim putnicima koji </span></span>
<span id="cb465-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-4" aria-hidden="true" tabindex="-1"></a><span class="co"># u imenu imaju `George` ili `Frank`</span></span>
<span id="cb465-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-6" aria-hidden="true" tabindex="-1"></a><span class="co"># provjerite ima li u podatkovnom skupu duplih obzervacija</span></span>
<span id="cb465-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-8" aria-hidden="true" tabindex="-1"></a><span class="co"># nasumično izaberite i ispišite podatke o pet putnika/putnica koji nisu preživjeli potonuće</span></span>
<span id="cb465-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-9" aria-hidden="true" tabindex="-1"></a><span class="co"># ispis poredati silazno po cijeni karte </span></span>
<span id="cb465-10"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb465-11"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb465-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite podatke o pet najstarijih putnica prve klase </span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb466-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite podatke o svim putnicima/putnicama prve klase starijim od 60 godina</span></span>
<span id="cb466-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb466-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(titanic, Pclass <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Age <span class="sc">&gt;</span> <span class="dv">60</span>)</span></code></pre></div>
<pre><code>## # A tibble: 14 × 12
##    PassengerId Survived Pclass Name   Sex     Age SibSp Parch Ticket  Fare Cabin
##          &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;chr&gt;  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
##  1          55 0        1      Ostby… male     65     0     1 113509  62.0 B30  
##  2          97 0        1      Golds… male     71     0     0 PC 17…  34.7 A5   
##  3         171 0        1      Van d… male     61     0     0 111240  33.5 B19  
##  4         253 0        1      Stead… male     62     0     0 113514  26.6 C87  
##  5         276 1        1      Andre… fema…    63     1     0 13502   78.0 D7   
##  6         439 0        1      Fortu… male     64     1     4 19950  263   C23 …
##  7         457 0        1      Mille… male     65     0     0 13509   26.6 E38  
##  8         494 0        1      Artag… male     71     0     0 PC 17…  49.5 &lt;NA&gt; 
##  9         546 0        1      Nicho… male     64     0     0 693     26   &lt;NA&gt; 
## 10         556 0        1      Wrigh… male     62     0     0 113807  26.6 &lt;NA&gt; 
## 11         626 0        1      Sutto… male     61     0     0 36963   32.3 D50  
## 12         631 1        1      Barkw… male     80     0     0 27042   30   A23  
## 13         746 0        1      Crosb… male     70     1     1 WE/P …  71   B22  
## 14         830 1        1      Stone… fema…    62     0     0 113572  80   B28  
## # … with 1 more variable: Embarked &lt;fct&gt;</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb468-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite podatke o svim preživjelim putnicima koji </span></span>
<span id="cb468-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb468-2" aria-hidden="true" tabindex="-1"></a><span class="co"># u imenu imaju `George` ili `Frank`</span></span>
<span id="cb468-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb468-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(titanic, <span class="fu">str_detect</span>(Name, <span class="st">&quot;(George|Frank)&quot;</span>) <span class="sc">&amp;</span> Sex <span class="sc">==</span> <span class="st">&quot;male&quot;</span> <span class="sc">&amp;</span> Survived <span class="sc">==</span> <span class="dv">1</span>)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##   PassengerId Survived Pclass Name    Sex     Age SibSp Parch Ticket  Fare Cabin
##         &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1         166 1        3      &quot;Golds… male   9        0     2 363291  20.5 &lt;NA&gt; 
## 2         371 1        1      &quot;Harde… male  25        1     0 11765   55.4 E50  
## 3         508 1        1      &quot;Bradl… male  NA        0     0 111427  26.6 &lt;NA&gt; 
## 4         571 1        2      &quot;Harri… male  62        0     0 S.W./…  10.5 &lt;NA&gt; 
## 5         710 1        3      &quot;Mouba… male  NA        1     1 2661    15.2 &lt;NA&gt; 
## 6         832 1        2      &quot;Richa… male   0.83     1     1 29106   18.8 &lt;NA&gt; 
## # … with 1 more variable: Embarked &lt;fct&gt;</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb470-1" aria-hidden="true" tabindex="-1"></a><span class="co"># provjerite ima li u podatkovnom skupu duplih obzervacija</span></span>
<span id="cb470-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb470-2" aria-hidden="true" tabindex="-1"></a><span class="fu">nrow</span>(titanic) <span class="sc">==</span> <span class="fu">nrow</span>(<span class="fu">distinct</span>(titanic))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb472-1" aria-hidden="true" tabindex="-1"></a><span class="co"># nasumično izaberite i ispišite podatke o pet putnika/putnica koji nisu preživjeli potonuće</span></span>
<span id="cb472-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb472-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ispis poredati silazno po cijeni karte</span></span>
<span id="cb472-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb472-3" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(titanic, Survived <span class="sc">==</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Fare))</span></code></pre></div>
<pre><code>## # A tibble: 5 × 12
##   PassengerId Survived Pclass Name    Sex     Age SibSp Parch Ticket  Fare Cabin
##         &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1         496 0        3      Yousse… male     NA     0     0 2627   14.5  &lt;NA&gt; 
## 2         464 0        2      Millin… male     48     0     0 234360 13    &lt;NA&gt; 
## 3         869 0        3      van Me… male     NA     0     0 345777  9.5  &lt;NA&gt; 
## 4          92 0        3      Andrea… male     20     0     0 347466  7.85 &lt;NA&gt; 
## 5          61 0        3      Siraya… male     22     0     0 2669    7.23 &lt;NA&gt; 
## # … with 1 more variable: Embarked &lt;fct&gt;</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb474-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite podatke o pet najstarijih putnica prve klase </span></span>
<span id="cb474-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb474-2" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(titanic, Pclass <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Sex <span class="sc">==</span> <span class="st">&quot;female&quot;</span>) <span class="sc">%&gt;%</span> <span class="fu">slice_max</span>(Age, <span class="at">n =</span> <span class="dv">5</span>) </span></code></pre></div>
<pre><code>## # A tibble: 6 × 12
##   PassengerId Survived Pclass Name    Sex     Age SibSp Parch Ticket  Fare Cabin
##         &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;chr&gt;   &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
## 1         276 1        1      Andrew… fema…    63     1     0 13502   78.0 D7   
## 2         830 1        1      Stone,… fema…    62     0     0 113572  80   B28  
## 3         367 1        1      Warren… fema…    60     1     0 110813  75.2 D37  
## 4          12 1        1      Bonnel… fema…    58     0     0 113783  26.6 C103 
## 5         196 1        1      Lurett… fema…    58     0     0 PC 17… 147.  B80  
## 6         269 1        1      Graham… fema…    58     0     1 PC 17… 153.  C125 
## # … with 1 more variable: Embarked &lt;fct&gt;</code></pre>
</div>
<hr />
<p>Uočili smo da kod paketa <code>dplyr</code> imena stupaca ne moramo stavljati unutar navodnih znakova niti kontinuirano referencirati originalni podatkovni okvir. Ovo je moguće zbog činjenice da se <code>tidyverse</code> paketi često oslanjaju na tzv. “nestadardnu evaluaciju” (eng. <em>non-standard evaluation</em>), uglavnom kako bi programerima olakšali pisanje programskog koda. Iako nam ovo u velikom broju slučajeva pomaže, postoje scenariji kad nam nestandardna evaluacija smeta, kao npr. ako je ime stupca pohranjeno u varijablu. U takvim slučajevima stupcu moramo pristupati “zaobilaznim putem” uz pomoć posebnog parametra <code>.data</code> koji referencira originalni podatkovni okvir i operatora <code>[[</code>.</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb476-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ime stupca pohranjeno je u varijablu</span></span>
<span id="cb476-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb476-2" aria-hidden="true" tabindex="-1"></a>passId <span class="ot">=</span> <span class="st">&quot;PassengerId&quot;</span></span>
<span id="cb476-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb476-3" aria-hidden="true" tabindex="-1"></a>titanic <span class="sc">%&gt;%</span> <span class="fu">filter</span>(.data[[passId]] <span class="sc">&lt;</span> <span class="dv">100</span>)  <span class="co"># umjesto filter(passId &lt; 100)</span></span></code></pre></div>
<hr />
</div>
<div id="stvaranje-podskupa-varijabli-uz-select" class="section level2 hasAnchor" number="11.3">
<h2><span class="header-section-number">11.3</span> Stvaranje podskupa varijabli uz <code>select</code><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-podskupa-varijabli-uz-select" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Druga metoda rezanja podatkovnog okvira jest odabir podskupa stupaca. Za razliku od biranja podskupa redaka, gdje se najčešće služimo logičkim indeksiranjem tj. filtriranjem po određenom kriteriju, stupce tj. varijable najčešće referenciramo po njihovom imenu. Sintaksa odabira podskupa stupaca po imenu uz pomoć osnovnog načina indeksiranja u <em>R</em>-u izgleda na primjer ovako:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb477-1" aria-hidden="true" tabindex="-1"></a>podaci[, <span class="fu">c</span>(<span class="st">&quot;a&quot;</span>, <span class="st">&quot;b&quot;</span>, <span class="st">&quot;c&quot;</span>)]</span></code></pre></div>
<p>Ovdje također uočavamo određenu nespretnost i teškoću interpretacije. Nazivi stupaca moraju biti ugrađeni u funkciju stvaranja vektora što smanjuje čitljivost, a naredba nigdje eksplicitno ne iskazuje da se radi o odabiru stupaca već do moramo zaključiti iz položaja indeksnog vektora. Dodatno, nema jednostavnog načina za odabir raspona stupaca po imenu, postojanju nekog podniza ili uzorka unutar imena i sl.</p>
<p>Funkcija <code>select</code> nam omogućuje eksplicitni odabir stupaca uz pomoć sintakse:</p>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb478-1" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(podaci, a, b, c)</span></code></pre></div>
<p>Dakle jednostavno navodimo podatkovni okvir i niz stupaca koje želimo odabrati. Ovdje je također lako uočiti sličnost sa SQL-om, konkretno SELECT segmentom SQL upita.</p>
<p>No gornja sintaksa nije sve što ova funkcija nudi - <code>select</code> ima čitav niz pomoćnih funkcija i operatora koji uvelike proširuju njezinu funkcionalnost, kao npr:</p>
<ul>
<li><code>select(podaci, a:c)</code> - odaberi stupce od <code>a</code> do <code>c</code></li>
<li><code>select(podaci, -a, -b)</code> - odaberi sve stupce osim <code>a</code> i <code>b</code></li>
<li><code>select(podaci, starts_with("PO")))</code> - odaberi stupce koji počinju sa slovima <code>"PO"</code></li>
<li><code>select(podaci, contains("stup"))</code> - odaberi stupce koji sadrže podniz <code>"stup"</code></li>
<li><code>select(podaci, matches("[123]{2,3}"))</code> - odaberi stupce koji odgovaraju danom regularnom izrazu</li>
<li><code>pull(podaci, a)</code> - odabir jednog stupca (prema imenu ili indeksu) u vektorskom obliku</li>
</ul>
<p>Ovo nisu sve mogućnosti, no dodatne opcije lako je pronaći u službenoj dokumentaciji.</p>
<p>Isprobajmo ovu naredbu, također na podatkovnom skupu Titanic.</p>
<hr />
<p><strong>Zadatak 11.4 - funkcija <code>select</code></strong></p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-1" aria-hidden="true" tabindex="-1"></a><span class="co"># za nasumično odabranih 10 redaka ispišite ime putnika/putnice, dob te </span></span>
<span id="cb479-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-2" aria-hidden="true" tabindex="-1"></a><span class="co"># da li je preživio/la potonuće ili ne</span></span>
<span id="cb479-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-4" aria-hidden="true" tabindex="-1"></a><span class="co"># za prvih 10 najstarijih putnika (gledano oba spola) ispišite sve atribute </span></span>
<span id="cb479-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-5" aria-hidden="true" tabindex="-1"></a><span class="co"># od imena do cijene karte</span></span>
<span id="cb479-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-7" aria-hidden="true" tabindex="-1"></a><span class="co"># za nasumično odabranih 1% redaka ispišite sve atribute osim identifikatora </span></span>
<span id="cb479-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-8" aria-hidden="true" tabindex="-1"></a><span class="co"># putnika i broja kabine</span></span>
<span id="cb479-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-10"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-10" aria-hidden="true" tabindex="-1"></a><span class="co"># za retke od broja 10 do broja 20 ispišite sve stupce koji počinju samoglasnikom</span></span>
<span id="cb479-11"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb479-12"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-12" aria-hidden="true" tabindex="-1"></a><span class="co"># za nasumičnih 10 putnika (gledano oba spola) koji imaju nepoznat broj godina  </span></span>
<span id="cb479-13"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-13" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite sve atribute od imena do cijene karte, </span></span>
<span id="cb479-14"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-14" aria-hidden="true" tabindex="-1"></a><span class="co"># potom putničku klasu te konačno da li je putnik preživio ili ne</span></span>
<span id="cb479-15"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb479-15" aria-hidden="true" tabindex="-1"></a><span class="co"># poredajte ispis abecedno po imenu</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb480-1" aria-hidden="true" tabindex="-1"></a><span class="co"># za nasumično odabranih 10 redaka ispišite ime putnika/putnice, dob te</span></span>
<span id="cb480-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb480-2" aria-hidden="true" tabindex="-1"></a><span class="co"># da li je preživio/la potonuće ili ne</span></span>
<span id="cb480-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb480-3" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_sample</span>(titanic, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Name, Age, Survived)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    Name                                                              Age Survi…¹
##    &lt;chr&gt;                                                           &lt;dbl&gt; &lt;fct&gt;  
##  1 Panula, Mrs. Juha (Maria Emilia Ojala)                          41    0      
##  2 Taussig, Miss. Ruth                                             18    1      
##  3 Sirayanian, Mr. Orsen                                           22    0      
##  4 Lemore, Mrs. (Amelia Milley)                                    34    1      
##  5 Hamalainen, Master. Viljo                                        0.67 1      
##  6 Sandstrom, Miss. Marguerite Rut                                  4    1      
##  7 Baclini, Miss. Marie Catherine                                   5    1      
##  8 Stead, Mr. William Thomas                                       62    0      
##  9 Penasco y Castellana, Mrs. Victor de Satode (Maria Josefa Pere… 17    1      
## 10 Hassan, Mr. Houssein G N                                        11    0      
## # … with abbreviated variable name ¹​Survived</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb482-1" aria-hidden="true" tabindex="-1"></a><span class="co"># za prvih 10 najstarijih putnika (gledano oba spola) ispišite sve atribute </span></span>
<span id="cb482-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb482-2" aria-hidden="true" tabindex="-1"></a><span class="co"># od imena do cijene karte</span></span>
<span id="cb482-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb482-3" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_max</span>(titanic, Age, <span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(Name<span class="sc">:</span>Fare)</span></code></pre></div>
<pre><code>## # A tibble: 11 × 7
##    Name                                 Sex     Age SibSp Parch Ticket      Fare
##    &lt;chr&gt;                                &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;      &lt;dbl&gt;
##  1 Barkworth, Mr. Algernon Henry Wilson male   80       0     0 27042      30   
##  2 Svensson, Mr. Johan                  male   74       0     0 347060      7.78
##  3 Goldschmidt, Mr. George B            male   71       0     0 PC 17754   34.7 
##  4 Artagaveytia, Mr. Ramon              male   71       0     0 PC 17609   49.5 
##  5 Connors, Mr. Patrick                 male   70.5     0     0 370369      7.75
##  6 Mitchell, Mr. Henry Michael          male   70       0     0 C.A. 24580 10.5 
##  7 Crosby, Capt. Edward Gifford         male   70       1     1 WE/P 5735  71   
##  8 Wheadon, Mr. Edward H                male   66       0     0 C.A. 24579 10.5 
##  9 Ostby, Mr. Engelhart Cornelius       male   65       0     1 113509     62.0 
## 10 Duane, Mr. Frank                     male   65       0     0 336439      7.75
## 11 Millet, Mr. Francis Davis            male   65       0     0 13509      26.6</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb484-1" aria-hidden="true" tabindex="-1"></a><span class="co"># za nasumično odabranih 1% redaka ispišite sve atribute osim identifikatora </span></span>
<span id="cb484-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb484-2" aria-hidden="true" tabindex="-1"></a><span class="co"># putnika i broja kabine</span></span>
<span id="cb484-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb484-3" aria-hidden="true" tabindex="-1"></a><span class="fu">slice_sample</span>(titanic, <span class="at">prop =</span> <span class="fl">0.01</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">-</span>PassengerId, <span class="sc">-</span>Cabin)</span></code></pre></div>
<pre><code>## # A tibble: 8 × 10
##   Survived Pclass Name              Sex     Age SibSp Parch Ticket  Fare Embar…¹
##   &lt;fct&gt;    &lt;fct&gt;  &lt;chr&gt;             &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;fct&gt;  
## 1 0        3      Thorneycroft, Mr… male     NA     1     0 376564 16.1  S      
## 2 1        3      Nilsson, Miss. H… fema…    26     0     0 347470  7.85 S      
## 3 1        2      Faunthorpe, Mrs.… fema…    29     1     0 2926   26    S      
## 4 1        3      Jansson, Mr. Car… male     21     0     0 350034  7.80 S      
## 5 0        2      Eitemiller, Mr. … male     23     0     0 29751  13    S      
## 6 0        3      Sdycoff, Mr. Tod… male     NA     0     0 349222  7.90 S      
## 7 1        2      Davies, Master. … male      8     1     1 C.A. … 36.8  S      
## 8 0        3      Reed, Mr. James … male     NA     0     0 362316  7.25 S      
## # … with abbreviated variable name ¹​Embarked</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb486-1" aria-hidden="true" tabindex="-1"></a><span class="co"># za retke od broja 10 do broja 20 ispišite sve stupce koji počinju samoglasnikom</span></span>
<span id="cb486-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb486-2" aria-hidden="true" tabindex="-1"></a><span class="fu">slice</span>(titanic, <span class="dv">10</span><span class="sc">:</span><span class="dv">20</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">matches</span>(<span class="st">&quot;^[aeiouAEIOU]&quot;</span>))</span></code></pre></div>
<pre><code>## # A tibble: 11 × 2
##      Age Embarked
##    &lt;dbl&gt; &lt;fct&gt;   
##  1    14 C       
##  2     4 S       
##  3    58 S       
##  4    20 S       
##  5    39 S       
##  6    14 S       
##  7    55 S       
##  8     2 Q       
##  9    NA S       
## 10    31 S       
## 11    NA C</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb488-1" aria-hidden="true" tabindex="-1"></a><span class="co"># za nasumičnih 10 putnika (gledano oba spola) koji imaju nepoznat broj godina  </span></span>
<span id="cb488-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb488-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite sve atribute od imena do cijene karte, </span></span>
<span id="cb488-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb488-3" aria-hidden="true" tabindex="-1"></a><span class="co"># potom putničku klasu te konačno da li je putnik preživio ili ne</span></span>
<span id="cb488-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb488-4" aria-hidden="true" tabindex="-1"></a><span class="co"># poredajte ispis abecedno po imenu</span></span>
<span id="cb488-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb488-5" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(titanic, <span class="fu">is.na</span>(Age)) <span class="sc">%&gt;%</span> <span class="fu">slice_sample</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb488-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb488-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Name<span class="sc">:</span>Fare, Pclass, Survived) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Name)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 9
##    Name                      Sex     Age SibSp Parch Ticket  Fare Pclass Survi…¹
##    &lt;chr&gt;                     &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;fct&gt;  &lt;fct&gt;  
##  1 &quot;Boulos, Mr. Hanna&quot;       male     NA     0     0 2664    7.22 3      0      
##  2 &quot;Kelly, Miss. Mary&quot;       fema…    NA     0     0 14312   7.75 3      1      
##  3 &quot;Lennon, Mr. Denis&quot;       male     NA     1     0 370371 15.5  3      0      
##  4 &quot;Madigan, Miss. Margaret… fema…    NA     0     0 370370  7.75 3      1      
##  5 &quot;McMahon, Mr. Martin&quot;     male     NA     0     0 370372  7.75 3      0      
##  6 &quot;Moubarek, Master. Halim… male     NA     1     1 2661   15.2  3      1      
##  7 &quot;O&#39;Dwyer, Miss. Ellen \&quot;… fema…    NA     0     0 330959  7.88 3      1      
##  8 &quot;Plotcharsky, Mr. Vasil&quot;  male     NA     0     0 349227  7.90 3      0      
##  9 &quot;Sage, Mr. Frederick&quot;     male     NA     8     2 CA. 2… 69.6  3      0      
## 10 &quot;Zabour, Miss. Thamine&quot;   fema…    NA     1     0 2665   14.5  3      0      
## # … with abbreviated variable name ¹​Survived</code></pre>
</div>
<hr />
</div>
<div id="stvaranje-novih-stupaca-uz-mutate" class="section level2 hasAnchor" number="11.4">
<h2><span class="header-section-number">11.4</span> Stvaranje novih stupaca uz <code>mutate</code><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#stvaranje-novih-stupaca-uz-mutate" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>U radu sa podatkovnim skupovima često se pojavi potreba za stvaranjem dodatnih varijabli uz pomoć informacija pohranjenih u jednoj ili više postojećih varijabli. Novi stupac najčešće stvaramo uz pomoć nekog izraza koji opisuje na koji način transformiramo postojeće podatke; motivacija može biti normalizacija numeričke varijable, stvaranje indikatorske ili kategorijske varijable, sumiranje više varijabli u jednu jedinstvenu varijablu ili bilo koja druga transformacija s ciljem dobivanja nove varijable koja je na neki način potrebna za daljnji proces analize.</p>
<p>Ako pretpostavimo stvaranje novog stupca koji će pohraniti zbroj numeričkih vrijednosti postojećih stupaca, onda bi uz pomoć osnovnih funkcija <em>R</em>-a to proveli na sljedeći način:</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb490-1" aria-hidden="true" tabindex="-1"></a>podaci<span class="sc">$</span>c <span class="ot">&lt;-</span> podaci<span class="sc">$</span>a <span class="sc">+</span> podaci<span class="sc">$</span>b</span></code></pre></div>
<p>Paket <code>dplyr</code> nam nudi alternativu u obliku funkcija <code>mutate</code> i <code>transmute</code>:</p>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb491-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(podaci, <span class="at">c =</span> a <span class="sc">+</span> b)</span>
<span id="cb491-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb491-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb491-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb491-3" aria-hidden="true" tabindex="-1"></a><span class="fu">transmute</span>(podaci, <span class="at">c =</span> a <span class="sc">+</span> b)</span></code></pre></div>
<p>Razlika: <code>mutate</code> vraća cijeli originalni podatkovni okvir uz novostvorene stupce, dok <code>transmute</code> zadržava samo one koje smo naveli unutar poziva funkcije. Zbog toga <code>transmute</code> možemo koristiti kao skraćenu kombinaciju <code>mutate</code> i <code>select</code>, npr:</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb492-1" aria-hidden="true" tabindex="-1"></a><span class="fu">transmute</span>(podaci, a, <span class="at">c =</span> a <span class="sc">+</span> b)</span>
<span id="cb492-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb492-2" aria-hidden="true" tabindex="-1"></a><span class="co"># isto kao i mutate(podaci, c = a + b) %&gt;% select(a, c)</span></span></code></pre></div>
<p>(NAPOMENA: Ovdje se ne moramo bojati degradacije performansi zbog kopiranja okvira, budući da <em>R</em> kod dodavanja stupca radi “plitku kopiju” (<em>shallow copy</em>), tj. novi okvir samo referencira novi stupac dok dijeli reference na preostale stupce sa “originalnim” okvirom. “Duboka kopija” (<em>deep copy</em>) bi značilo da se svi stupci kopiraju u potpuno novi okvir, u kojem slučaju bi ova operacija bila resursno “skupa”)</p>
<p>Uočite da <code>mutate</code> i <code>transmute</code> nisu alternative naredbi <em>UPDATE</em> iz <em>SQL</em>-a, već zapravo odgovaraju <em>SELECT</em> segmentu naredbe u scenarijima kada ne biramo pojedine stupce već ih kombiniramo u sklopu izraza.</p>
<p>Funkcije <code>mutate</code> i <code>transmute</code> koriste uobičajene (vektorizirane) funkcije i operatore, a imamo na raspolaganju i niz dodatnih tzv. “prozorskih” (<em>window</em>) funkcija, za koje je specifično da izlazna vrijednost za pojedini redak ovisi o cijelom skupu ulaznih vrijednosti. Neke funkcija koje još nismo upoznali su:</p>
<ul>
<li><code>ntile</code>, <code>cut</code> - stvaranje kategorijske varijable koja grupira vrijednosti u <code>n</code> ladica; <code>ntile</code> će napraviti kategorije jednake veličine, dok će <code>cut</code> rezati u ovisnosti o veličini intervala numeričkih vrijednosti</li>
<li><code>dense_rank</code>, <code>min_rank</code> - rangiranje obzervacija (razlika je samo u tretiranju obzervacija sa istim vrijednostima)</li>
<li><code>between</code> - opisuje da li je varijabla nekog stupca u intervalu zadanom sa dva druga stupca</li>
<li><code>pmin</code>, <code>pmax</code> - “paralelni minimum i maksimum”, tj. minimum ili maksimum vrijednosti odabranih stupaca gledano po retcima</li>
<li>itd.</li>
</ul>
<p>Popis svih dostupnih funkcija može se pronaći u dokumentaciji.</p>
<hr />
<p><strong>Zadatak 11.5 - funkcija <code>mutate</code></strong></p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tablici `titanic` dodajte logički stupac `hadRelativesOnBoard` koji će opisivati</span></span>
<span id="cb493-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-2" aria-hidden="true" tabindex="-1"></a><span class="co"># da li je putnik imao rodbine na brodu</span></span>
<span id="cb493-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-5" aria-hidden="true" tabindex="-1"></a><span class="co"># za nasumičnih 10 putnica starijih od 20 godina koje su se ukrcale u Southamptonu</span></span>
<span id="cb493-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite ime putnice, putničku klasu i prilagođenu cijenu karte</span></span>
<span id="cb493-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-7" aria-hidden="true" tabindex="-1"></a><span class="co"># cijenu karte zamijenite odgovarajućom cijenom koliko bi ona iznosila danas</span></span>
<span id="cb493-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-8" aria-hidden="true" tabindex="-1"></a><span class="co">#   (pretpostavite da je $1 iz 1912. jednak današnjih $23.85, uračunavajući inflaciju)</span></span>
<span id="cb493-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-9" aria-hidden="true" tabindex="-1"></a><span class="co"># novi stupac nazovite `FareToday` a </span></span>
<span id="cb493-10"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-10" aria-hidden="true" tabindex="-1"></a><span class="co"># iznos zaokružite na dvije decimale i dodajte prefiks `$`</span></span>
<span id="cb493-11"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ispis poredajte po putničkoj klasi silazno</span></span>
<span id="cb493-12"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-13"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-14"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-14" aria-hidden="true" tabindex="-1"></a><span class="co"># stvorite stupac FareCategory kojim ćete podijeliti cijene karata </span></span>
<span id="cb493-15"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-15" aria-hidden="true" tabindex="-1"></a><span class="co"># u pet kategorija jednake veličine</span></span>
<span id="cb493-16"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-16" aria-hidden="true" tabindex="-1"></a><span class="co"># potom nasumično izaberite 20 redaka i ispišite </span></span>
<span id="cb493-17"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-17" aria-hidden="true" tabindex="-1"></a><span class="co"># ime putnika, putničku klasu, cijenu karte i kategoriju</span></span>
<span id="cb493-18"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-18" aria-hidden="true" tabindex="-1"></a><span class="co"># ispis poredajte po kategoriji cijene</span></span>
<span id="cb493-19"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-20"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-21"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-21" aria-hidden="true" tabindex="-1"></a><span class="co"># tablici `titanic` dodajte stupac `EmbarkationPort` u kojem će pisati puno </span></span>
<span id="cb493-22"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-22" aria-hidden="true" tabindex="-1"></a><span class="co"># ime luke ukrcaja (Southampton, Queenstown ili Cherbourg)</span></span>
<span id="cb493-23"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-23" aria-hidden="true" tabindex="-1"></a><span class="co"># koristite `mutate` i dva `ifelse`</span></span>
<span id="cb493-24"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-25"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb493-26"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb493-26" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite prvih 10 redaka tablice `titanic`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb494-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tablici `titanic` dodajte logički stupac `hadRelativesOnBoard` koji će opisivati</span></span>
<span id="cb494-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb494-2" aria-hidden="true" tabindex="-1"></a><span class="co"># da li je putnik imao rodbine na brodu</span></span>
<span id="cb494-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb494-3" aria-hidden="true" tabindex="-1"></a>titanic <span class="ot">&lt;-</span> <span class="fu">mutate</span>(titanic, <span class="at">hadRelativesOnBoard =</span> SibSp <span class="sc">&gt;</span> <span class="dv">0</span> <span class="sc">|</span> Parch <span class="sc">&gt;</span> <span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb495-1" aria-hidden="true" tabindex="-1"></a><span class="co"># za nasumičnih 10 putnica starijih od 20 godina koje su se ukrcale u Southamptonu</span></span>
<span id="cb495-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb495-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite ime putnice, putničku klasu i prilagođenu cijenu karte</span></span>
<span id="cb495-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb495-3" aria-hidden="true" tabindex="-1"></a><span class="co"># cijenu karte zamijenite odgovarajućom cijenom koliko bi ona iznosila danas</span></span>
<span id="cb495-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb495-4" aria-hidden="true" tabindex="-1"></a><span class="co">#   (pretpostavite da je $1 iz 1912. jednak današnjih $23.85, uračunavajući inflaciju)</span></span>
<span id="cb495-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb495-5" aria-hidden="true" tabindex="-1"></a><span class="co"># novi stupac nazovite `FareToday` a iznos zaokružite na dvije decimale i dodajte prefiks `$`</span></span>
<span id="cb495-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb495-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ispis poredajte po putničkoj klasi silazno</span></span>
<span id="cb495-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb495-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb495-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb495-8" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(titanic, Sex <span class="sc">==</span> <span class="st">&#39;female&#39;</span>, Age <span class="sc">&gt;</span> <span class="dv">20</span>,  Embarked <span class="sc">==</span> <span class="st">&#39;S&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">10</span>) <span class="sc">%&gt;%</span>  </span>
<span id="cb495-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb495-9" aria-hidden="true" tabindex="-1"></a><span class="fu">transmute</span>(Name, Pclass, <span class="at">FareToday =</span> <span class="fu">str_c</span>(<span class="st">&quot;$&quot;</span>, <span class="fu">round</span>(Fare <span class="sc">*</span> <span class="fl">23.85</span>, <span class="dv">2</span>))) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(Pclass))</span></code></pre></div>
<pre><code>## # A tibble: 10 × 3
##    Name                                                     Pclass FareToday
##    &lt;chr&gt;                                                    &lt;fct&gt;  &lt;chr&gt;    
##  1 Dahlberg, Miss. Gerda Ulrika                             3      $250.82  
##  2 Panula, Mrs. Juha (Maria Emilia Ojala)                   3      $946.55  
##  3 Honkanen, Miss. Eliina                                   3      $189.01  
##  4 Louch, Mrs. Charles Alexander (Alice Adelaide Slow)      2      $620.1   
##  5 Buss, Miss. Kate                                         2      $310.05  
##  6 Davis, Miss. Mary                                        2      $310.05  
##  7 Trout, Mrs. William H (Jessie L)                         2      $301.7   
##  8 Rothes, the Countess. of (Lucy Noel Martha Dyer-Edwards) 1      $2063.02 
##  9 Robert, Mrs. Edward Scott (Elisabeth Walton McMillan)    1      $5040.4  
## 10 Longley, Miss. Gretchen Fiske                            1      $1859.31</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb497-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stvorite stupac FareCategory kojim ćete podijeliti cijene karata </span></span>
<span id="cb497-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb497-2" aria-hidden="true" tabindex="-1"></a><span class="co"># u pet kategorija jednake veličine</span></span>
<span id="cb497-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb497-3" aria-hidden="true" tabindex="-1"></a><span class="co"># potom nasumično izaberite 20 redaka i ispišite </span></span>
<span id="cb497-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb497-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ime putnika, putničku klasu, cijenu karte i kategoriju</span></span>
<span id="cb497-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb497-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ispis poredajte po kategoriji cijene</span></span>
<span id="cb497-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb497-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb497-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb497-7" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(titanic, <span class="at">FareCategory =</span> <span class="fu">ntile</span>(Fare, <span class="dv">5</span>)) <span class="sc">%&gt;%</span> <span class="fu">sample_n</span>(<span class="dv">20</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb497-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb497-8" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span>(Name, Pclass, Fare, FareCategory) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(FareCategory)</span></code></pre></div>
<pre><code>## # A tibble: 20 × 4
##    Name                                           Pclass   Fare FareCategory
##    &lt;chr&gt;                                          &lt;fct&gt;   &lt;dbl&gt;        &lt;int&gt;
##  1 Pettersson, Miss. Ellen Natalia                3        7.78            1
##  2 Soholt, Mr. Peter Andreas Lauritz Andersen     3        7.65            1
##  3 Johanson, Mr. Jakob Alfred                     3        6.50            1
##  4 Gheorgheff, Mr. Stanio                         3        7.90            2
##  5 Sirota, Mr. Maurice                            3        8.05            2
##  6 Lievens, Mr. Rene Aime                         3        9.5             2
##  7 Larsson, Mr. August Viktor                     3        9.48            2
##  8 Dahl, Mr. Karl Edwart                          3        8.05            2
##  9 Goldsmith, Mrs. Frank John (Emily Alice Brown) 3       20.5             3
## 10 Hosono, Mr. Masabumi                           2       13               3
## 11 Lindell, Mr. Edvard Bengtsson                  3       15.6             3
## 12 Shellard, Mr. Frederick William                3       15.1             3
## 13 Walker, Mr. William Anderson                   1       34.0             4
## 14 West, Mrs. Edwy Arthur (Ada Mary Worth)        2       27.8             4
## 15 Weir, Col. John                                1       26.6             4
## 16 Collyer, Mrs. Harvey (Charlotte Annie Tate)    2       26.2             4
## 17 Moran, Miss. Bertha                            3       24.2             4
## 18 Chaffee, Mr. Herbert Fuller                    1       61.2             5
## 19 Marvin, Mr. Daniel Warner                      1       53.1             5
## 20 Bissette, Miss. Amelia                         1      136.              5</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb499-1" aria-hidden="true" tabindex="-1"></a><span class="co"># tablici `titanic` dodajte stupac `EmbarkationPort` u kojem će pisati puno ime luke ukrcaja</span></span>
<span id="cb499-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb499-2" aria-hidden="true" tabindex="-1"></a><span class="co">#   (Southampton, Queenstown ili Cherbourg)</span></span>
<span id="cb499-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb499-3" aria-hidden="true" tabindex="-1"></a><span class="co"># koristite `mutate` i dva `ifelse`</span></span>
<span id="cb499-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb499-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mutate</span>(titanic, <span class="at">EmbarkationPort =</span> <span class="fu">ifelse</span>(Embarked <span class="sc">==</span> <span class="st">&#39;S&#39;</span>, <span class="st">&#39;Southampton&#39;</span>, </span>
<span id="cb499-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb499-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">ifelse</span>(Embarked <span class="sc">==</span> <span class="st">&#39;C&#39;</span>, <span class="st">&#39;Cherbourg&#39;</span>, <span class="st">&#39;Queenstown&#39;</span>))) <span class="ot">-&gt;</span> titanic</span>
<span id="cb499-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb499-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb499-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb499-7" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite prvih 10 redaka tablice `titanic`</span></span>
<span id="cb499-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb499-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(titanic, <span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 14
##    PassengerId Survived Pclass Name   Sex     Age SibSp Parch Ticket  Fare Cabin
##          &lt;dbl&gt; &lt;fct&gt;    &lt;fct&gt;  &lt;chr&gt;  &lt;fct&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;chr&gt;
##  1           1 0        3      Braun… male     22     1     0 A/5 2…  7.25 &lt;NA&gt; 
##  2           2 1        1      Cumin… fema…    38     1     0 PC 17… 71.3  C85  
##  3           3 1        3      Heikk… fema…    26     0     0 STON/…  7.92 &lt;NA&gt; 
##  4           4 1        1      Futre… fema…    35     1     0 113803 53.1  C123 
##  5           5 0        3      Allen… male     35     0     0 373450  8.05 &lt;NA&gt; 
##  6           6 0        3      Moran… male     NA     0     0 330877  8.46 &lt;NA&gt; 
##  7           7 0        1      McCar… male     54     0     0 17463  51.9  E46  
##  8           8 0        3      Palss… male      2     3     1 349909 21.1  &lt;NA&gt; 
##  9           9 1        3      Johns… fema…    27     0     2 347742 11.1  &lt;NA&gt; 
## 10          10 1        2      Nasse… fema…    14     1     0 237736 30.1  &lt;NA&gt; 
## # … with 3 more variables: Embarked &lt;fct&gt;, hadRelativesOnBoard &lt;lgl&gt;,
## #   EmbarkationPort &lt;chr&gt;</code></pre>
</div>
</div>
<div id="ogledni-podatkovni-skup-houston-flights" class="section level2 hasAnchor" number="11.5">
<h2><span class="header-section-number">11.5</span> Ogledni podatkovni skup: <em>Houston flights</em><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#ogledni-podatkovni-skup-houston-flights" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Učitajmo paket <code>dplyr</code> i podatkovni okvir <code>hflights</code> koji se nalazi u paketu istog imena i može ga se dohvatiti iz CRAN repozitorija. Nakon učitavanja paketa podatkovni okvir možemo prebaciti u globalnu okolinu uz pomoć funkcije <code>data</code>.</p>
<hr />
<p><strong>Zadatak 11.6 - podatkovni skup <code>hflights</code></strong></p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb501-1" aria-hidden="true" tabindex="-1"></a><span class="co"># učitajte paket `hflights`</span></span>
<span id="cb501-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb501-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ukoliko je potrebno instalirajte ga sa CRAN repozitorija</span></span>
<span id="cb501-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb501-3" aria-hidden="true" tabindex="-1"></a><span class="co"># uz pomoć funkcije `data` učitajte okvir u globalnu okolinu</span></span>
<span id="cb501-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb501-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb501-5" aria-hidden="true" tabindex="-1"></a><span class="co"># pretvorite okvir u `hflights` u &quot;tibble&quot;</span></span>
<span id="cb501-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb501-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb501-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb501-7" aria-hidden="true" tabindex="-1"></a><span class="co"># upoznajte se s podatkovnim skupom `hflights`</span></span>
<span id="cb501-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb501-8" aria-hidden="true" tabindex="-1"></a><span class="co"># pored funkcija glimpse/head/itd. možete pogledati i dokumentaciju</span></span>
<span id="cb501-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb501-9" aria-hidden="true" tabindex="-1"></a><span class="co"># skupa uz pomoć naredbe `?hflights`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb502-1" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;hflights&quot;)  # ukoliko je potrebno</span></span>
<span id="cb502-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb502-2" aria-hidden="true" tabindex="-1"></a><span class="co">#library(dplyr)               # ako već nisu učitani</span></span>
<span id="cb502-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb502-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(hflights)             </span></span>
<span id="cb502-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb502-4" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(hflights)</span>
<span id="cb502-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb502-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb502-6" aria-hidden="true" tabindex="-1"></a>hflights <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(hflights)</span>
<span id="cb502-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb502-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb502-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb502-8" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(hflights)</span>
<span id="cb502-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb502-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(hflights)</span></code></pre></div>
<pre><code>## Rows: 227,496
## Columns: 21
## $ Year              &lt;int&gt; 2011, 2011, 2011, 2011, 2011, 2011, 2011, 2011, 2011…
## $ Month             &lt;int&gt; 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1…
## $ DayofMonth        &lt;int&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 1…
## $ DayOfWeek         &lt;int&gt; 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2, 3, 4, 5, 6, 7, 1, 2…
## $ DepTime           &lt;int&gt; 1400, 1401, 1352, 1403, 1405, 1359, 1359, 1355, 1443…
## $ ArrTime           &lt;int&gt; 1500, 1501, 1502, 1513, 1507, 1503, 1509, 1454, 1554…
## $ UniqueCarrier     &lt;chr&gt; &quot;AA&quot;, &quot;AA&quot;, &quot;AA&quot;, &quot;AA&quot;, &quot;AA&quot;, &quot;AA&quot;, &quot;AA&quot;, &quot;AA&quot;, &quot;AA&quot;…
## $ FlightNum         &lt;int&gt; 428, 428, 428, 428, 428, 428, 428, 428, 428, 428, 42…
## $ TailNum           &lt;chr&gt; &quot;N576AA&quot;, &quot;N557AA&quot;, &quot;N541AA&quot;, &quot;N403AA&quot;, &quot;N492AA&quot;, &quot;N…
## $ ActualElapsedTime &lt;int&gt; 60, 60, 70, 70, 62, 64, 70, 59, 71, 70, 70, 56, 63, …
## $ AirTime           &lt;int&gt; 40, 45, 48, 39, 44, 45, 43, 40, 41, 45, 42, 41, 44, …
## $ ArrDelay          &lt;int&gt; -10, -9, -8, 3, -3, -7, -1, -16, 44, 43, 29, 5, -9, …
## $ DepDelay          &lt;int&gt; 0, 1, -8, 3, 5, -1, -1, -5, 43, 43, 29, 19, -2, -3, …
## $ Origin            &lt;chr&gt; &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IAH&quot;, &quot;IA…
## $ Dest              &lt;chr&gt; &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DFW&quot;, &quot;DF…
## $ Distance          &lt;int&gt; 224, 224, 224, 224, 224, 224, 224, 224, 224, 224, 22…
## $ TaxiIn            &lt;int&gt; 7, 6, 5, 9, 9, 6, 12, 7, 8, 6, 8, 4, 6, 5, 6, 12, 8,…
## $ TaxiOut           &lt;int&gt; 13, 9, 17, 22, 9, 13, 15, 12, 22, 19, 20, 11, 13, 15…
## $ Cancelled         &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## $ CancellationCode  &lt;chr&gt; &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, &quot;&quot;, …
## $ Diverted          &lt;int&gt; 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0…
## # A tibble: 6 × 21
##    Year Month DayofMonth DayOf…¹ DepTime ArrTime Uniqu…² Fligh…³ TailNum Actua…⁴
##   &lt;int&gt; &lt;int&gt;      &lt;int&gt;   &lt;int&gt;   &lt;int&gt;   &lt;int&gt; &lt;chr&gt;     &lt;int&gt; &lt;chr&gt;     &lt;int&gt;
## 1  2011     1          1       6    1400    1500 AA          428 N576AA       60
## 2  2011     1          2       7    1401    1501 AA          428 N557AA       60
## 3  2011     1          3       1    1352    1502 AA          428 N541AA       70
## 4  2011     1          4       2    1403    1513 AA          428 N403AA       70
## 5  2011     1          5       3    1405    1507 AA          428 N492AA       62
## 6  2011     1          6       4    1359    1503 AA          428 N262AA       64
## # … with 11 more variables: AirTime &lt;int&gt;, ArrDelay &lt;int&gt;, DepDelay &lt;int&gt;,
## #   Origin &lt;chr&gt;, Dest &lt;chr&gt;, Distance &lt;int&gt;, TaxiIn &lt;int&gt;, TaxiOut &lt;int&gt;,
## #   Cancelled &lt;int&gt;, CancellationCode &lt;chr&gt;, Diverted &lt;int&gt;, and abbreviated
## #   variable names ¹​DayOfWeek, ²​UniqueCarrier, ³​FlightNum, ⁴​ActualElapsedTime</code></pre>
</div>
<hr />
</div>
<div id="grupiranje-i-agregacija-uz-group_by-i-summarise" class="section level2 hasAnchor" number="11.6">
<h2><span class="header-section-number">11.6</span> Grupiranje i agregacija uz <code>group_by</code> i <code>summarise</code><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#grupiranje-i-agregacija-uz-group_by-i-summarise" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>U literaturi koja se bavi analizom podataka često ćemo naići na tzv. SAC paradigmu (engl. <em>Split-Apply-Combine</em>). Radi se o strategiji koja se svodi na rastavljanje velikog zadatka na manje dijelove, obavljanje određenog posla na svakom od dijelova te konačno kombiniranje svih rezultata u jedinstvenu cjelinu. Potrebu za ovom paradigmom nailazimo u različitim scenarijima analize - u eksploratornoj analizi podataka htjet ćemo izračunati različite statistike ili stvoriti nove varijable zasebno za različite podskupove podataka (npr. ovisno o nekoj kategorijskoj varijabli); kod obrade iznimno velikih količina podataka često želimo ubrzati proces obrade na način da podatke razbijemo u manje skupove koji će se svaki obrađivati zasebno (poznati princip <em>Map-Reduce</em>).</p>
<p>Poznavatelji <em>SQL</em>-a će ovaj princip lako prepoznati kao grupiranje i agregaciju koji se provode kroz <em>GROUP BY</em> segment <em>SQL</em> upita uz prateće elemente u <em>SELECT</em> dijelu. Paket <code>dplyr</code> nudi vrlo sličnu funkcionalnost (iako na proceduralni način) - prvo provedemo “grupiranje”, tj. stvaranje podskupova redaka nekog okvira, a onda provodimo daljnje obrade paralelno nad svakim podskupom, da bi na kraju sve rezultate sakupili u jedinstveni podatkovni okvir.</p>
<p>Za grupiranje <code>dplyr</code> nudi funkciju <code>group_by</code> kojom tablicu (podatkovni okvir) pretvaramo u “grupiranu tablicu” (<code>grouped_tbl</code>):</p>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb504-1" aria-hidden="true" tabindex="-1"></a><span class="fu">group_by</span>(podaci, a, b, c)</span></code></pre></div>
<hr />
<p>Grupiranjem nismo izgubili nikakvu informaciju - grupirani podatkovni okvir i dalje izgleda identično originalnom, “negrupiranom” okviru. Zapravo jedina naznaka da je nešto drugačije jest nova, nasljeđena klasa te redak <code>Groups:..</code> u ispisu redaka. Ovo znači da je grupiranje okvira samo naznaka da se neke daljnje (najčešće agregacijske) operacije ne izvode nad cijelim okvirom, već nad pojedinim grupama. Isto tako, ukoliko želimo, okvir uvijek možemo lako “odgrupirati” uz pomoć funkcije <code>ungroup</code>.</p>
<p>Za agregaciju se koristimo funkcijom <code>summarise</code> koja prima podatke (grupiranu tablicu) a potom kombinacije agregacijskih funkcija i stupaca nad kojim se iste izvršavaju, npr.:</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb505-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(podaci, <span class="at">meanA =</span> <span class="fu">mean</span>(a), <span class="at">sdA =</span> <span class="fu">sd</span>(a))</span></code></pre></div>
<p>NAPOMENA: funkcija <code>summarise</code> će ponekad izbaciti “prijateljsko” upozorenje o “ispuštenim grupama”. Ovo je relevantno samo ako radimo višerazinsku agregaciju i grupiranje, tj. ako nad rezultatom inicijalnog grupiranja i agregacije želimo vršiti daljnja grupiranja i agregacije. Kako bismo izbjegli pojavu ovog upozorenja, možemo eksplicitno postaviti parametar <code>.groups</code> na jednu od vrijednosti koja nam odgovara prema dokumentaciju (ili bilo koju, ako nemamo u planu raditi višerazinsku agregaciju, npr. <code>.groups = 'drop'</code>).</p>
<p>Za agregacijsku funkciju u pravilu možemo koristiti bilo koju funkciju koja vektor vrijednosti svodi na jednu vrijednost (npr. <code>mean</code>, <code>max</code>, <code>sd</code> itd.), a često korištene funkcije koje nudi sam paket <code>dplyr</code> su:</p>
<ul>
<li><code>first</code>, <code>last</code>, <code>nth</code> - prvi, zadnji, <code>n</code>-ti element grupe</li>
<li><code>n</code>, <code>n_distinct</code> - broj (jedinstvenih) vrijednosti</li>
</ul>
<p>NAPOMENA: ukoliko u skupu kojeg agregiramo postoje nedostajuće vrijednosti (<code>NA</code>), veliki broj agregacijskih funkcija će kao konačni rezultat također dati nedostajuću vrijednosti. Ukoliko želimo provesti agregaciju uz ignoriranje nedostajućih vrijednosti, moramo koristiti parametar <code>na.rm = T</code></p>
<hr />
<p><strong>Zadatak 11.7 - funkcije <code>group_by</code> i <code>summarise</code></strong></p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb506-1" aria-hidden="true" tabindex="-1"></a><span class="co"># izračunajte prosječno kašnjenje u dolasku leta za varijablu `flights` </span></span>
<span id="cb506-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb506-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb506-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb506-3" aria-hidden="true" tabindex="-1"></a><span class="co"># potom izračunajte prosječno kašnjenje po mjesecu</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb507-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(hflights, <span class="at">meanDelay =</span> <span class="fu">mean</span>(ArrDelay, <span class="at">na.rm =</span> T))</span>
<span id="cb507-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb507-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;------------------------&quot;</span>)   </span>
<span id="cb507-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb507-3" aria-hidden="true" tabindex="-1"></a>hflights <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Month) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">meanDelay =</span> <span class="fu">mean</span>(ArrDelay, <span class="at">na.rm =</span> T))</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##   meanDelay
##       &lt;dbl&gt;
## 1      7.09
## [1] &quot;------------------------&quot;
## # A tibble: 12 × 2
##    Month meanDelay
##    &lt;int&gt;     &lt;dbl&gt;
##  1     1      4.93
##  2     2      6.35
##  3     3      7.89
##  4     4     11.1 
##  5     5     13.1 
##  6     6     10.8 
##  7     7      9.62
##  8     8      4.53
##  9     9      4.24
## 10    10      3.72
## 11    11      3.22
## 12    12      5.01</code></pre>
</div>
<p>Uočite da je poželjno imenovati agregirane stupce.</p>
<hr />
<p>Jedan od češćih agregacijskih zadataka jest prebrojavanje opservacija unutar grupe. Funkcija <code>count</code> nam omogućuje da ovo obavimo skraćenom sintaksom, pa je tako</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb509-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">count</span>(a, b)</span></code></pre></div>
<p>ekvivalentno sa</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb510-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(a, b) <span class="sc">%&gt;%</span> <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<p>NAPOMENA: Uočite razliku između funkcije <code>count</code> i funkcije <code>table</code>! Kod korištenja funkcije <code>count</code> rezultat je podatkovni okvir, kojeg lako prosljeđujemo u daljnju obradu ili koristimo kao ulaz za stvaranje vizualizacija.</p>
<p>Ukoliko želimo promijeniti ime stupca (npr. ne odgovara nam da se stupac nakon obavljanja funkcije <code>count</code> zove <code>n</code>) možemo se poslužiti funkcijom <code>rename</code>.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb511-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">novo_ime =</span> staro_ime)</span></code></pre></div>
<p>Rezultat funkcije je novi podatkovni okvir gdje su navedena stara imena zamjenjena novima.</p>
<p>Funkcija <code>rename_with</code> omogućuje primjenu odabrane funkcije na imena stupaca.</p>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb512-1" aria-hidden="true" tabindex="-1"></a>df <span class="sc">%&gt;%</span> <span class="fu">rename_with</span>(funkcija, stupci)</span></code></pre></div>
<p><strong>Zadatak 11.8 - funkcija <code>count</code></strong></p>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb513-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite koliko u skupu `hflights` ima opservacija</span></span>
<span id="cb513-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb513-2" aria-hidden="true" tabindex="-1"></a><span class="co"># po zrakoplovnoj tvrtki</span></span>
<span id="cb513-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb513-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb513-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb513-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb513-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite koliko je u svakom mjesecu bilo otkazanih letova zbog lošeg vremena</span></span>
<span id="cb513-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb513-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (za uvid koja varijabla indicira otkazivanje leta zbog lošeg vremena</span></span>
<span id="cb513-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb513-7" aria-hidden="true" tabindex="-1"></a><span class="co"># proučite dokumentaciju skupa)</span></span>
<span id="cb513-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb513-8" aria-hidden="true" tabindex="-1"></a><span class="co"># stupce izlaznog okvira nazovite `&quot;Month&quot;` i `&quot;BadWeatherCancellations&quot;`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb514-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite koliko u skupu `hflights` ima opservacija</span></span>
<span id="cb514-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb514-2" aria-hidden="true" tabindex="-1"></a><span class="co"># po zrakoplovnoj tvrtki</span></span>
<span id="cb514-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb514-3" aria-hidden="true" tabindex="-1"></a>hflights <span class="sc">%&gt;%</span> <span class="fu">count</span>(UniqueCarrier)</span></code></pre></div>
<pre><code>## # A tibble: 15 × 2
##    UniqueCarrier     n
##    &lt;chr&gt;         &lt;int&gt;
##  1 AA             3244
##  2 AS              365
##  3 B6              695
##  4 CO            70032
##  5 DL             2641
##  6 EV             2204
##  7 F9              838
##  8 FL             2139
##  9 MQ             4648
## 10 OO            16061
## 11 UA             2072
## 12 US             4082
## 13 WN            45343
## 14 XE            73053
## 15 YV               79</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb516-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite koliko je u svakom mjesecu bilo otkazanih letova zbog lošeg vremena</span></span>
<span id="cb516-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb516-2" aria-hidden="true" tabindex="-1"></a><span class="co"># (za uvid koja varijabla indicira otkazivanje leta zbog lošeg vremena</span></span>
<span id="cb516-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb516-3" aria-hidden="true" tabindex="-1"></a><span class="co"># proučite dokumentaciju skupa)</span></span>
<span id="cb516-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb516-4" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(hflights, CancellationCode <span class="sc">==</span> <span class="st">&#39;B&#39;</span>) <span class="sc">%&gt;%</span> <span class="fu">count</span>(Month) <span class="sc">%&gt;%</span> </span>
<span id="cb516-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb516-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">BadWeatherCancellations =</span> n)</span></code></pre></div>
<pre><code>## # A tibble: 12 × 2
##    Month BadWeatherCancellations
##    &lt;int&gt;                   &lt;int&gt;
##  1     1                     149
##  2     2                     929
##  3     3                      50
##  4     4                      40
##  5     5                     106
##  6     6                      49
##  7     7                      29
##  8     8                     108
##  9     9                      38
## 10    10                      46
## 11    11                      13
## 12    12                      95</code></pre>
</div>
<hr />
<p>Pokušajmo sada iskoristiti sva dosadašnja saznanja o paketu <code>dplyr</code> i riješiti sljedeće primjere. Svi zadaci vezani su uz cijeli podatkovni skup <code>hflights</code>.</p>
<p><strong>Zadatak 11.9 - složeni upiti</strong></p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite prosječno vrijeme kašnjenja u dolasku</span></span>
<span id="cb518-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-2" aria-hidden="true" tabindex="-1"></a><span class="co"># kod odlaznih letova u zrakoplovne luke </span></span>
<span id="cb518-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-3" aria-hidden="true" tabindex="-1"></a><span class="co"># LAX, JFK i LGA u različitim danima u tjednu</span></span>
<span id="cb518-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-4" aria-hidden="true" tabindex="-1"></a><span class="co"># novi stupac nazovite &#39;MeanArrDelay&#39;</span></span>
<span id="cb518-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ignorirajte retke sa NA vrijednostima vremena kašnjenja</span></span>
<span id="cb518-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ispis poredajte po vremenu kašnjenja silazno</span></span>
<span id="cb518-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb518-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-8" aria-hidden="true" tabindex="-1"></a><span class="co"># za svaku zrakoplovnu tvrtku ispišite </span></span>
<span id="cb518-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-9" aria-hidden="true" tabindex="-1"></a><span class="co"># kojih pet letova je imalo najveće vrijeme kašnjenja</span></span>
<span id="cb518-10"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-10" aria-hidden="true" tabindex="-1"></a><span class="co"># u mjesecu veljači</span></span>
<span id="cb518-11"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ispis mora sadržavati datum leta (stupac tipa `Date`), oznaku zrakoplovne tvrtke,</span></span>
<span id="cb518-12"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb518-12" aria-hidden="true" tabindex="-1"></a><span class="co"># oznaku leta i vrijeme kašnjenja</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite prosječno vrijeme kašnjenja u dolasku</span></span>
<span id="cb519-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-2" aria-hidden="true" tabindex="-1"></a><span class="co"># kod odlaznih letova u zrakoplovne luke </span></span>
<span id="cb519-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-3" aria-hidden="true" tabindex="-1"></a><span class="co"># LAX, JFK i LGA u različitim danima u tjednu</span></span>
<span id="cb519-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-4" aria-hidden="true" tabindex="-1"></a><span class="co"># novi stupac nazovite &#39;MeanArrDelay&#39;</span></span>
<span id="cb519-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ignorirajte retke sa NA vrijednostima vremena kašnjenja</span></span>
<span id="cb519-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-6" aria-hidden="true" tabindex="-1"></a><span class="co"># ispis poredajte po vremenu kašnjenja silazno</span></span>
<span id="cb519-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb519-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-9" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(hflights, Dest <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;LAX&#39;</span>, <span class="st">&#39;JFK&#39;</span>, <span class="st">&#39;LGA&#39;</span>)) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(DayOfWeek, Dest) <span class="sc">%&gt;%</span> </span>
<span id="cb519-10"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-10" aria-hidden="true" tabindex="-1"></a><span class="fu">summarise</span>(<span class="at">MeanArrDelay =</span> </span>
<span id="cb519-11"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-11" aria-hidden="true" tabindex="-1"></a>            <span class="fu">round</span>(<span class="fu">mean</span>(ArrDelay, <span class="at">na.rm =</span> T) , <span class="dv">2</span>), <span class="at">.groups =</span> <span class="st">&#39;drop&#39;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb519-12"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb519-12" aria-hidden="true" tabindex="-1"></a>         <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(<span class="fu">desc</span>(MeanArrDelay))</span></code></pre></div>
<pre><code>## # A tibble: 21 × 3
##    DayOfWeek Dest  MeanArrDelay
##        &lt;int&gt; &lt;chr&gt;        &lt;dbl&gt;
##  1         4 LGA          21.3 
##  2         4 JFK          17.2 
##  3         5 LGA          13.6 
##  4         1 LGA          13.5 
##  5         7 JFK          10.8 
##  6         1 LAX          10.7 
##  7         3 LGA          10.5 
##  8         4 LAX          10.3 
##  9         2 LGA           9.85
## 10         6 JFK           9.76
## # … with 11 more rows</code></pre>
</div>
<div class="fold s o">
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb521-1" aria-hidden="true" tabindex="-1"></a><span class="co"># za svaku zrakoplovnu tvrtku ispišite </span></span>
<span id="cb521-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb521-2" aria-hidden="true" tabindex="-1"></a><span class="co"># kojih pet letova je imalo najveće vrijeme kašnjenja</span></span>
<span id="cb521-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb521-3" aria-hidden="true" tabindex="-1"></a><span class="co"># u dolasku mjesecu veljači</span></span>
<span id="cb521-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb521-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ispis mora sadržavati datum leta (stupac tipa `Date`), oznaku zrakoplovne tvrtke,</span></span>
<span id="cb521-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb521-5" aria-hidden="true" tabindex="-1"></a><span class="co"># oznaku leta i vrijeme kašnjenja u dolasku</span></span>
<span id="cb521-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb521-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb521-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb521-7" aria-hidden="true" tabindex="-1"></a>hflights <span class="sc">%&gt;%</span> <span class="fu">filter</span>(Month <span class="sc">==</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(UniqueCarrier) <span class="sc">%&gt;%</span> </span>
<span id="cb521-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb521-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_max</span>(ArrDelay, <span class="at">n =</span> <span class="dv">5</span>) <span class="sc">%&gt;%</span> <span class="fu">unite</span>(Date, Year, Month, DayofMonth) <span class="sc">%&gt;%</span> </span>
<span id="cb521-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb521-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(<span class="at">Date =</span> <span class="fu">ymd</span>(Date), UniqueCarrier, FlightNum, ArrDelay)</span></code></pre></div>
<pre><code>## # A tibble: 72 × 4
## # Groups:   UniqueCarrier [15]
##    Date       UniqueCarrier FlightNum ArrDelay
##    &lt;date&gt;     &lt;chr&gt;             &lt;int&gt;    &lt;int&gt;
##  1 2011-02-04 AA                 1294      158
##  2 2011-02-17 AA                 1225      129
##  3 2011-02-02 AA                 1121      111
##  4 2011-02-04 AA                  533      100
##  5 2011-02-24 AA                 1298       92
##  6 2011-02-28 AS                  731      183
##  7 2011-02-17 AS                  731       33
##  8 2011-02-09 AS                  731       30
##  9 2011-02-22 AS                  731       22
## 10 2011-02-05 AS                  731       20
## # … with 62 more rows</code></pre>
</div>
<hr />
</div>
<div id="spajanje-podatkovnih-okvira-uz-join-funkcije" class="section level2 hasAnchor" number="11.7">
<h2><span class="header-section-number">11.7</span> Spajanje podatkovnih okvira uz join funkcije<a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#spajanje-podatkovnih-okvira-uz-join-funkcije" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Spajanje podatkovnih okvira jest operacija poznata svim programerima koji imaju iskustvo u radu sa relacijskim bazama podataka i <em>SQL</em>-om. Kod pohrane u relacijsku bazu podataka tablice se često dekomponiraju u više tablica postupkom koji se naziva “normalizacija”. Svrha normalizacije je poglavito uklanjanje nepotrebne redundancije - svaka tablica zadržava dovoljno podataka kako bi se prema potrebi operacijom spajanja mogli rekonstruirati originalni podaci tj. skupovi obzervacija.</p>
<p>Iako postoje različiti oblici spajanja tablica, daleko najčešće je tzv. “prirodno” spajanje kod koje u jednoj tablici imamo jedinstvene identifikatore vezane uz podatke koji se nalaze u drugoj tablici. Na primjer - zamislimo da imamo tablice Korisnik i Mjesto, gdje tablica korisnika sustava može imati stupac koji pohranjuje poštanski broj mjesta boravišta korisnika, dok se ostali podaci vezani uz mjesta nalaze u drugoj tablici. Pohraniti naziv mjesta u tablicu s korisnicima bilo bi redundantno, budući da poštanski broj kao takav jedinstveno identificira mjesto, a ukoliko želimo kod ispisa korisnika vidjeti i nazive mjesta, obavljamo operaciju prirodnog spajanja dvije tablice po poštanskom broju mjesta koje je tzv. “strani ključ” u tablici <em>Korisnik</em> a istovremeno i “primarni ključ” u tablici <em>Mjesto</em>.</p>
<p>Stvorimo ovakve podatkovne okvire (sa tek nekoliko redaka kako bi koncept bio jasniji).</p>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb523-1" aria-hidden="true" tabindex="-1"></a><span class="co"># inicijalizacija podatkovnih okvira `korisnik` i `mjesto`</span></span>
<span id="cb523-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb523-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb523-3" aria-hidden="true" tabindex="-1"></a>korisnik <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">id =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>), <span class="at">prezime =</span> <span class="fu">c</span>(<span class="st">&quot;Ivic&quot;</span>, <span class="st">&quot;Peric&quot;</span>, <span class="st">&quot;Anic&quot;</span>),</span>
<span id="cb523-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb523-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">pbrBoravista =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">31000</span>, <span class="dv">10000</span>))</span>
<span id="cb523-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb523-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb523-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb523-6" aria-hidden="true" tabindex="-1"></a>mjesto <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( <span class="at">pbr =</span> <span class="fu">c</span>(<span class="dv">10000</span>, <span class="dv">21000</span>, <span class="dv">31000</span>), </span>
<span id="cb523-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb523-7" aria-hidden="true" tabindex="-1"></a>                      <span class="at">naziv =</span> <span class="fu">c</span>(<span class="st">&quot;Zagreb&quot;</span>, <span class="st">&quot;Split&quot;</span>, <span class="st">&quot;Osijek&quot;</span>))</span></code></pre></div>
<p>Ako bi htjeli imati okvir sa stupcima <em>(id, prezime, pbrBoravista, naziv)</em>, moramo prirodno spojiti ova dva okvira. Paket <code>dplyr</code> za ovo nudi funkciju <code>inner_join</code>:</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb524-1" aria-hidden="true" tabindex="-1"></a><span class="fu">inner_join</span>(df1, df2, <span class="at">by=</span><span class="fu">c</span>(<span class="st">&quot;s1&quot;</span> <span class="ot">=</span> <span class="st">&quot;s2&quot;</span>))</span></code></pre></div>
<p>gdje su <code>df1</code> i <code>df2</code> podatkovni okviri koje spajamo, a nizovi znakova <em>“s1”</em> i <em>“s2”</em> označavaju imena stupaca “lijevog” i “desnog” okvira prema kojima provodimo spajanje (uočite samo jedan znak jednakosti!). Ukoliko stupac kojeg koristimo ima isto ime u obje tablice možemo navesti samo ime tog stupca (ili znakovni vektor više stupaca ako spajamo preko tzv. “kompozitnog” stranog ključa), ili taj parametar potpuno ispustiti (ako su stupci prema kojima provodimo spajanje jedini stupci čiji se nazivi poklapaju).</p>
<hr />
<p><strong>Zadatak 11.10 - prirodno spajanje</strong></p>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb525-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stvorite okvir `korisnikMjesto` koji će biti rezultat</span></span>
<span id="cb525-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb525-2" aria-hidden="true" tabindex="-1"></a><span class="co"># prirodnog spajanja okvira `korisnik` i `mjesto`</span></span>
<span id="cb525-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb525-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb525-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb525-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb525-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite okvir `korisnikMjesto`</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb526-1" aria-hidden="true" tabindex="-1"></a>korisnikMjesto <span class="ot">&lt;-</span> <span class="fu">inner_join</span>(korisnik, mjesto, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;pbrBoravista&quot;</span> <span class="ot">=</span> <span class="st">&quot;pbr&quot;</span>))</span>
<span id="cb526-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb526-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb526-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb526-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb526-4" aria-hidden="true" tabindex="-1"></a>korisnikMjesto</span></code></pre></div>
<pre><code>##   id prezime pbrBoravista  naziv
## 1  1    Ivic        10000 Zagreb
## 2  2   Peric        31000 Osijek
## 3  3    Anic        10000 Zagreb</code></pre>
</div>
<hr />
<p>Vodite računa da je spajanje vrlo “skupa” operacija; ako spajate okvire sa vrlo velikim brojem redaka operacija bi mogla trajati vrlo dugo i zauzeti dosta memorije. U slučaju da često dolazi do potrebe za ovakvim “velikim” spajanjima, onda se snažno preporučuje korištenje paketa data.table koji implementira algoritme sa znatno boljim performansama kod operacija spajanja (korištenjem indeksiranja), ili - ukoliko radimo s podacima iz relacijske baze - provesti spajanja na strani baze podataka i onda u <em>R</em> povući rezultat, umjesto da se spajanje ostavlja na odgovornost <em>R</em>-u. U idućem poglavlju prikazati ćemo kako se ovo potencijalno može izvesti i bez potrebe za pisanjem zasebnih <em>SQL</em> naredbi.</p>
<p>Ako pogledamo rezultat gornjeg primjera, možemo vidjeti da smo “izgubili” jedan redak tablice mjesto. Naime, redak <em>(21000, ‘Split’)</em> nije imao pripadajućeg korisnika te je “nestao” iz rezultata. Ovo je potpuno očekivani rezultat prirodnog spajanja, no postoje slučajevi kada želimo zadržati sve retke iz jedne od tablica koje spajamo. U tom slučaju koristimo tzv. “vanjsko spajanje” koje radi identično već viđenom, ali zadržava sve retke iz jedne ili obje od tablica na način da retci koji se ne uspiju spojiti ostaju u rezultatu, ali sa <code>NA</code> vrijednostima sa suprotne strane. Razlikujemo “lijevo”, “desno”, i “puno” vanjsko spajanje, u ovisnosti želimo li zadržati sve retke iz lijeve, desne ili obje tablice. Paket <code>dplyr</code> nudi funkcije koje obavljaju sve ove tipove spajanja, one imaju potpis identičan gore viđenoj funkciji a zovu se <code>left_join</code>, <code>right_join</code> i <code>full_join</code>.</p>
<hr />
<p><strong>Zadatak 11.11 - vanjsko spajanje</strong></p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb528-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stvorite okvir `korisnikMjesto2` koji će biti rezultat</span></span>
<span id="cb528-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb528-2" aria-hidden="true" tabindex="-1"></a><span class="co"># prirodnog spajanja okvira `korisnik` i `mjesto`</span></span>
<span id="cb528-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb528-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ali će zadržati sve retke iz tablice &#39;mjesto`</span></span>
<span id="cb528-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb528-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb528-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb528-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ispišite okvir `korisnikMjesto2`</span></span>
<span id="cb528-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb528-6" aria-hidden="true" tabindex="-1"></a><span class="co"># retke poredajte po identifikatoru korisnika</span></span></code></pre></div>
<div class="fold s o">
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb529-1" aria-hidden="true" tabindex="-1"></a>korisnikMjesto2 <span class="ot">&lt;-</span> <span class="fu">right_join</span>(korisnik, mjesto, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">&quot;pbrBoravista&quot;</span> <span class="ot">=</span> <span class="st">&quot;pbr&quot;</span>))</span>
<span id="cb529-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb529-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb529-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb529-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb529-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb529-4" aria-hidden="true" tabindex="-1"></a>korisnikMjesto2 <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(id)</span></code></pre></div>
<pre><code>##   id prezime pbrBoravista  naziv
## 1  1    Ivic        10000 Zagreb
## 2  2   Peric        31000 Osijek
## 3  3    Anic        10000 Zagreb
## 4 NA    &lt;NA&gt;        21000  Split</code></pre>
</div>
<hr />
</div>
<div id="integracija-sa-relacijskim-bazama-podataka" class="section level2 hasAnchor" number="11.8">
<h2><span class="header-section-number">11.8</span> Integracija sa relacijskim bazama podataka<a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#integracija-sa-relacijskim-bazama-podataka" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Relacijske baze česti su izvor podataka za analize koje radimo u jeziku <em>R</em>. Jedna od standardnih procedura pripreme podataka za analitički proces je tzv. “izvoženje” (engl. <em>export</em>) podataka iz baze u <em>CSV</em> datoteku, koja se potom učitava u <em>R</em>. Često se prije stvaranja <em>CSV</em> datoteke prvo podaci iz baze moraju prikupiti i pripremiti na adekvatan način, što znači da cjelokupni proces pripreme podataka incijalno zahtjeva rad u <em>SQL</em>-u nad bazom podataka. Ovo je pogotovo bitno ako radimo sa većim skupovima podataka koji bi nepotrebno opteretili stroj nad kojim radimo analize u <em>R</em>-u, a koji bi se mogli znatno učinkovitije i brže mogli obraditi u bazi podataka.</p>
<p>Gore navedeno ne znači nužno da nam za prikupljanje podataka iz baze treba zaseban alat pomoću kojeg ćemo izvoditi <em>SQL</em> upite. <em>R</em> sadrži niz paketa za direktno spajanje i rad sa popularnijim bazama podataka, kao što su npr. <em>MySQL</em> ili <em>PostgreSQL</em>. Uz pomoć ovih paketa možemo unutar <em>R</em> skripte uspostaviti konekciju sa bazom i izvoditi <em>SQL</em> upite, a sve uz pomoć R naredbi pri čemu kao konačni rezultat dobivamo podatkovni okvir spreman za daljnje korake analize. Npr. rad direktno nad <em>MySQL</em> bazom može izgledati ovako:</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb531-1" aria-hidden="true" tabindex="-1"></a><span class="fu">install.packages</span>(<span class="st">&quot;RMySQL&quot;</span>)</span>
<span id="cb531-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb531-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb531-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(RMySQL)</span>
<span id="cb531-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb531-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb531-5" aria-hidden="true" tabindex="-1"></a><span class="co"># unijeti stvarne parametre kod realnog scenarija!</span></span>
<span id="cb531-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb531-6" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">=</span> <span class="fu">dbConnect</span>(<span class="fu">MySQL</span>(), <span class="at">user=</span><span class="st">&#39;user&#39;</span>, <span class="at">password=</span><span class="st">&#39;password&#39;</span>, <span class="at">dbname=</span><span class="st">&#39;database_name&#39;</span>, <span class="at">host=</span><span class="st">&#39;host&#39;</span>)</span>
<span id="cb531-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb531-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb531-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb531-8" aria-hidden="true" tabindex="-1"></a>df <span class="ot">=</span> <span class="fu">dbSendQuery</span>(conn, <span class="st">&quot;SELECT * FROM MY_TABLE&quot;</span>)</span></code></pre></div>
<p>Vidimo da prvo moramo učitati paket s podrškom za spajanje na odabranu bazu, potom uspostavljamo konekciju sa bazom (parametre nam obično daje administrator same baze), a onda uz pomoć odgovarajućih funkcija postavljamo <em>SQL</em> upite). Iako ovakav pristup nije kompliciran i relativno se često koristi, on neumitno zahtijeva miješanje programskog koda u <em>SQL</em>-u i programskog koda u <em>R</em>-u.</p>
<p>Paket <code>dplyr</code> može ovdje pomoći na način da rastereti programera od potrebe pisanja <em>SQL</em> upita unutar <em>R</em> skripte. Naime, <code>dplyr</code> sadrži integriranu podršku za automatsku konverziju izraza koji koriste <code>dplyr</code> funkcije direktno u <em>SQL</em> upit, a što je transparentno za korisnika. Drugim riječima, do izvjesne mjere možemo na isti način raditi nad relacijskom bazom podataka kao da se radi o podatkovnim okvirima u memoriji računala. Ovdje trebamo biti oprezni jer ne možemo očekivati da će nam sve funkcionalnosti <code>dplyr</code>-a moći biti automatski prevedene u <em>SQL</em>, ali neke standardne pripremne operacije poput spajanje i filtriranja se na ovaj način mogu raditi direktno u bazi, a kroz čisti <em>R</em> programski kod.</p>
<p>Kako bi mogli ovo isprobati u praksi, potrebna nam je relacijska baza podataka. Budući da nije praktično u ovom trenutku instalirati ili pripremati postojeću relacijsku bazu podataka samo za potrebe nekolicine primjera, učinit ćemo ono što radi većina <em>R</em> programera kada želi razvijati programski kod vezan uz relacijske baze, ali izbjeći potrebu za pristupom konkretnoj bazi podataka - koristiti ćemo se tzv. <em>SQLite </em>bazom. Ovo je jednostavna baza koja ne zahtijeva posebnu instalaciju, ne koristi poslužitelj i sve podatke drži u jednoj datoteci.</p>
<p>U sljedećem programskom odsječku učitavamo paket <em>RSQLite</em>, stvaramo novu bazu kreiranjem nove datoteke (ili se spajamo na postojeću ako datoteka ne postoji) te spremamo okvir <code>mtcars</code> u tablicu <em>AUTI</em> što će nam glumiti “podatke u bazi”.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-1" aria-hidden="true" tabindex="-1"></a><span class="co"># instalacija i učitavanje paketa `RSQLite` (izvesti ako je potrebno)</span></span>
<span id="cb532-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-2" aria-hidden="true" tabindex="-1"></a><span class="co">#install.packages(&quot;RSQLite&quot;)      </span></span>
<span id="cb532-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-3" aria-hidden="true" tabindex="-1"></a><span class="co">#library(RSQLite)                 </span></span>
<span id="cb532-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-5" aria-hidden="true" tabindex="-1"></a><span class="co"># otvaramo konekciju sa bazom &quot;SQLite&quot;</span></span>
<span id="cb532-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-6" aria-hidden="true" tabindex="-1"></a><span class="co"># (zapravo stvaramo datoteku &#39;moja.baza&#39;)</span></span>
<span id="cb532-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-7" aria-hidden="true" tabindex="-1"></a>conn <span class="ot">&lt;-</span> <span class="fu">dbConnect</span>(<span class="at">drv=</span><span class="fu">SQLite</span>(), <span class="at">dbname=</span><span class="st">&quot;moja.baza&quot;</span>)</span>
<span id="cb532-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-9" aria-hidden="true" tabindex="-1"></a><span class="co"># stvaramo tablicu `AUTI` u koju pohranjujemo</span></span>
<span id="cb532-10"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-10" aria-hidden="true" tabindex="-1"></a><span class="co"># prvih 100 redaka tablice `mtcars`</span></span>
<span id="cb532-11"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ovo simulira &quot;tablicu u bazi&quot;</span></span>
<span id="cb532-12"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-12" aria-hidden="true" tabindex="-1"></a><span class="fu">dbWriteTable</span>(conn, <span class="st">&quot;AUTI&quot;</span>, mtcars[<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>,], <span class="at">overwrite =</span> T)</span>
<span id="cb532-13"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb532-14"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-14" aria-hidden="true" tabindex="-1"></a><span class="co"># provjeramo popis svih tablica</span></span>
<span id="cb532-15"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb532-15" aria-hidden="true" tabindex="-1"></a><span class="fu">dbListTables</span>(conn)</span></code></pre></div>
<pre><code>## [1] &quot;AUTI&quot;</code></pre>
<p>Uobičajeni način prikupljanja podataka iz baze jest ugradnja <em>SQL</em> upita direktno u <em>R</em> programski kod i pohrana rezultata u varijablu.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb534-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ispisujemo podatke o maksimalnoj brzini i težini svih automobila sa 6 cilindara</span></span>
<span id="cb534-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb534-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb534-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb534-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dbGetQuery</span>(conn, <span class="st">&quot;SELECT mpg, wt FROM AUTI WHERE cyl = 6&quot;</span>)</span></code></pre></div>
<pre><code>##    mpg    wt
## 1 21.0 2.620
## 2 21.0 2.875
## 3 21.4 3.215
## 4 18.1 3.460
## 5 19.2 3.440
## 6 17.8 3.440
## 7 19.7 2.770</code></pre>
<p>Ako dobro poznajemo SQL, onda ovakav način prikupljanja podataka vjerojatno ne izgleda pretjerano kompleksno i uistinu, veliki broj programera i analitičara rado kombinira <em>SQL</em> i <em>R</em> kako bi optimizirali proces prikupljanja i pripreme podataka. No ako nismo “jaki” u <em>SQ</em>L-u, ili jednostavno želimo “čistiji” kod, možemo se koristiti alatima koje nam nudi paket <code>dplyr</code>.</p>
<p>U idućem primjeru ponoviti ćemo dio gore prikazanog postupka (spojiti ćemo se na <em>SQLite</em> bazu nazvanu <em>moja.baza</em> i ispisati podatke iz tablice <em>AUTI</em>), ali ćemo sve izvesti uz pomoć <code>dplyr</code> funkcija.</p>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-1" aria-hidden="true" tabindex="-1"></a><span class="co"># povezujem se sa postojećom SQLite bazom</span></span>
<span id="cb536-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-2" aria-hidden="true" tabindex="-1"></a>conn2 <span class="ot">&lt;-</span> <span class="fu">src_sqlite</span>(<span class="st">&quot;moja.baza&quot;</span>, <span class="at">create =</span> <span class="cn">FALSE</span>)</span>
<span id="cb536-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-4" aria-hidden="true" tabindex="-1"></a><span class="co"># pogledajmo da li je tablica AUTI u bazi</span></span>
<span id="cb536-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-5" aria-hidden="true" tabindex="-1"></a><span class="fu">src_tbls</span>(conn2)</span>
<span id="cb536-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-7"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-7" aria-hidden="true" tabindex="-1"></a><span class="co"># stvaram referencu na ovu tablicu</span></span>
<span id="cb536-8"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-8" aria-hidden="true" tabindex="-1"></a><span class="co"># (ništa se ne učitava dok ne pristupam podacima!)</span></span>
<span id="cb536-9"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-9" aria-hidden="true" tabindex="-1"></a>auti <span class="ot">&lt;-</span> <span class="fu">tbl</span>(conn2, <span class="st">&quot;AUTI&quot;</span>)</span>
<span id="cb536-10"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb536-11"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ispisujemo podatke o maksimalnoj brzini i težini svih automobila sa 6 cilindara</span></span>
<span id="cb536-12"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb536-12" aria-hidden="true" tabindex="-1"></a>auti <span class="sc">%&gt;%</span> <span class="fu">filter</span>(cyl <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> <span class="fu">select</span>(mpg, wt) <span class="sc">%&gt;%</span> collect</span></code></pre></div>
<pre><code>## Warning: `src_sqlite()` was deprecated in dplyr 1.0.0.
## ℹ Please use `tbl()` directly with a database connection</code></pre>
<pre><code>## [1] &quot;AUTI&quot;
## # A tibble: 7 × 2
##     mpg    wt
##   &lt;dbl&gt; &lt;dbl&gt;
## 1  21    2.62
## 2  21    2.88
## 3  21.4  3.22
## 4  18.1  3.46
## 5  19.2  3.44
## 6  17.8  3.44
## 7  19.7  2.77</code></pre>
<p>Ključno je znati da <code>dplyr</code> neće ništa izvoditi do trenutka kada mi eksplicitno zatražimo tražene podatke, a i tada će ih dohvaćati “u porcijama” kako nam ne bi zagušio memoriju. Upravo zbog toga smo u gornjem primjeru koristili funkciju <code>collect</code>, koja zapravo znači “dohvati cijeli rezultat i pohrani ga u podatkovni okvir” (u našem slučaju mi smo ga jednostavno ispisali na zaslon). Na ovaj način <em>R</em> programer može znatno rasteretiti svoju <em>R</em> okolinu prebacujući odgovornost “teških” proračuna na bazu podataka, a sve uz korištenje istih funkcija koje koristi za upravljanje podatkovnim skupovima pohranjenim u memoriji računala u obliku podatkovnih okvira.</p>
<hr />
</div>
<div id="zadaci-za-vježbu-9" class="section level2 unnumbered hasAnchor">
<h2>Zadaci za vježbu<a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#zadaci-za-vježbu-9" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>U zadacima za vježbu poslužiti ćemo se proširenom podatkovnim skupom <em>mammals sleep</em> dostupnim u vizualizacijskom paketu <code>ggplot2</code>. Učitajte paket <code>ggplot2</code> te potom prenesite podatkovni okvir <code>msleep</code> u globalnu okolinu uz pomoć funkcije <code>data</code>.</p>
<p>Prije rješavanja učitajte podatkovni skup i upoznajte se s njim uz pomoć uobičajenih funkcija.</p>
<ol style="list-style-type: decimal">
<li><p>Za 10 biljojeda koji najdulje spavaju ispišite ime, koliko dnevno spavaju i prosječnu tjelesnu, težinu u kg. Ispis poredajte po duljini spavanja silazno.</p></li>
<li><p>Ispišite prosječno, najdulje i najkraće vrijeme spavanja životinja ovisno o njihovom tipu prehrane.</p></li>
<li><p>Podijelite ukupno vrijeme spavanja u 5 razreda jednoliko po ukupnoj duljini dnevnog spavanja. Za svaki razred ispišite ukupan broj životinja koje pripadaju razredu, a potom posebno ukupan broj pripadnika razreda koji nisu biljojedi. Ispis poredajte od razreda životinja koje najmanje spavaju naviše. Stupce nazovite smisleno i pripazite da konačna tablica nema NA vrijednosti.</p></li>
<li><p>Sljedeći okvir sadrži šifre statusa očuvanja životinja i njihove opise:</p></li>
</ol>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb539-1" aria-hidden="true" tabindex="-1"></a>conservationStatus <span class="ot">&lt;-</span> <span class="fu">data.frame</span>( </span>
<span id="cb539-2"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb539-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">code =</span> <span class="fu">c</span>(<span class="st">&quot;ex&quot;</span>, <span class="st">&quot;ew&quot;</span>, <span class="st">&quot;cr&quot;</span>, <span class="st">&quot;en&quot;</span>, <span class="st">&quot;vu&quot;</span>, <span class="st">&quot;nt&quot;</span>, <span class="st">&quot;cd&quot;</span>, <span class="st">&quot;lc&quot;</span>),</span>
<span id="cb539-3"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb539-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">description =</span> <span class="fu">c</span>(<span class="st">&quot;extinct&quot;</span>, <span class="st">&quot;extinct in the wild&quot;</span>, </span>
<span id="cb539-4"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb539-4" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;critically endangered&quot;</span>, <span class="st">&quot;endangered&quot;</span>,</span>
<span id="cb539-5"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb539-5" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;vulnerable&quot;</span>, <span class="st">&quot;near threatened&quot;</span>, </span>
<span id="cb539-6"><a href="prilagodba-podatkovnih-skupova-uz-paket-dplyr.html#cb539-6" aria-hidden="true" tabindex="-1"></a>                 <span class="st">&quot;conservation dependent&quot;</span>, <span class="st">&quot;least concern&quot;</span>))</span></code></pre></div>
<p>Dodajte okviru <code>msleep</code> stupac <code>conservationDesc</code> koji će sadržavati pripadajuće opise preuzete iz gornjeg okvira. Pripazite da kod proširenja ne izgubite nijedan redak iz okvira <code>msleep</code>.</p>
<hr />
<p><a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc-nd/4.0/88x31.png" /></a><br /><span xmlns:dct="http://purl.org/dc/terms/" property="dct:title">Programirajmo u R-u</span> by <a xmlns:cc="http://creativecommons.org/ns#" href="https://www.fer.unizg.hr/en/damir.pintar" property="cc:attributionName" rel="cc:attributionURL">Damir Pintar</a> is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by-nc-nd/4.0/">Creative Commons Attribution-NonCommercial-NoDerivatives 4.0 International License</a>.<br />Based on a work at <a xmlns:dct="http://purl.org/dc/terms/" href="https://ratnip.github.io/FER_OPJR/" rel="dct:source">https://ratnip.github.io/FER_OPJR/</a></p>

<div id="refs" class="references csl-bib-body hanging-indent">
<div class="csl-entry">
Bache, Stefan Milton, and Hadley Wickham. 2014. <em>Magrittr: A Forward-Pipe Operator for r</em>. <a href="https://CRAN.R-project.org/package=magrittr">https://CRAN.R-project.org/package=magrittr</a>.
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="datumi.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"],
"google": false,
"instapper": false
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["osnoveR.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed",
"edit": null,
"download": null,
"search": true
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
